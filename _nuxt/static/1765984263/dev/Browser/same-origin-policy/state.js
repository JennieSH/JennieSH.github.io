window.__NUXT__=(function(a,b,c){return {staticAssetsBase:"\u002F_nuxt\u002Fstatic\u002F1765984263",layout:"default",error:a,serverRendered:true,routePath:"\u002Fdev\u002FBrowser\u002Fsame-origin-policy",config:{_app:{basePath:"\u002F",assetsPath:"\u002F_nuxt\u002F",cdnURL:a}},globalRefs:{},ssrRefs:{"articleMatter-Browser-same-origin-policy":{info:{title:b,fileName:"same-origin-policy",description:"為什麼要有同源政策？來一起探討背後原因",createdAt:c,updatedAt:c,tags:["Network","同源政策","CORS","Browser"]},content:"\u003Ch6\u003Etags: \u003Ccode\u003ENetwork\u003C\u002Fcode\u003E \u003Ccode\u003E同源政策\u003C\u002Fcode\u003E \u003Ccode\u003ECORS\u003C\u002Fcode\u003E \u003Ccode\u003EBrowser\u003C\u002Fcode\u003E\u003C\u002Fh6\u003E\n\u003Ch1 id=\"同源政策 Same-Origin Policy\" title=\"同源政策 Same-Origin Policy\"\u003E同源政策 Same-Origin Policy\u003C\u002Fh1\u003E\n\u003Ch3\u003EWhy\u003C\u002Fh3\u003E\n\u003Cp\u003E防止\u003Cstrong\u003ECSRF 誇站請求偽造\u003C\u002Fstrong\u003E(Cross-site request forgery) :\u003C\u002Fp\u003E\n\u003Cp\u003E利用了 web 中用戶身分驗證的一個漏洞：簡單的身分驗證只能保證請求發自某個用戶的瀏覽器，卻不能保證請求本身是用戶自願發出的。\u003C\u002Fp\u003E\n\u003Ch3\u003ERules\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E相同協議(protocol)\u003C\u002Fli\u003E\n\u003Cli\u003E相同網域(domain)\u003C\u002Fli\u003E\n\u003Cli\u003E相同端口(port)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3\u003EMethod\u003C\u002Fh3\u003E\n\u003Ch4\u003E==CORS==\u003C\u002Fh4\u003E\n\u003Cp\u003E幾乎不太可能跟要接的 API 在同一 domain 下，所以為了讓不同源之間可以傳輸資料，又有另外一個規範叫 CORS。\u003C\u002Fp\u003E\n\u003Cp\u003ECORS 把請求分為兩種，簡單請求跟預檢(preflight)請求。\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EServer 必須在 Response 的 Header 裡面加上 Access-Control-Allow-Origin 的設定。\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E簡單請求\u003C\u002Fstrong\u003E\u003Cbr \u002F\u003E\n要滿足所有\u003Ca  href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fzh-TW\u002Fdocs\u002FWeb\u002FHTTP\u002FCORS#%E7%B0%A1%E5%96%AE%E8%AB%8B%E6%B1%82\" target=\"_blank\" rel=\"noreferrer noopener\"\u003E判斷條件\u003C\u002Fa\u003E，最容易分辨的是沒有自定義 Header，而且又是 GET 。\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"hljs\"\u003E\u003Ccode\u003E\u003Cspan class=\"hljs-variable constant_\"\u003EGET\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-attr\"\u003Ehttps\u003C\u002Fspan\u003E:\u003Cspan class=\"hljs-comment\"\u003E\u002F\u002Fapi.users.com\u002Fuser\u002F1 HTTP\u002F1.1\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003E預檢(preflight)請求\u003C\u002Fstrong\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E瀏覽器會先送出 HTTP 的 OPTIONS 方法，確認 Server 的 Response 是否有 Access- Control-Allow-Origin ，確認有之後才會把我們的請求送出。\u003C\u002Fp\u003E\n\u003Cdiv class=\"info\"\u003E\n\u003Cp\u003EOPTIONS 是一個 HTTP\u002F1.1 方法，這個方法用來確認來自伺服器進一步的資訊，重複執行不會造成任何影響\u003C\u002Fp\u003E\n\u003C\u002Fdiv\u003E\n\u003Cpre class=\"hljs\"\u003E\u003Ccode\u003E\n\u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E xhr = \u003Cspan class=\"hljs-keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title class_\"\u003EXMLHttpRequest\u003C\u002Fspan\u003E()\nxhr.\u003Cspan class=\"hljs-title function_\"\u003Eopen\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-string\"\u003E&quot;POST&quot;\u003C\u002Fspan\u003E,\u003Cspan class=\"hljs-string\"\u003E&quot;http:\u002F\u002Fapi&quot;\u003C\u002Fspan\u003E) \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F用post方法發請求到api網址\u003C\u002Fspan\u003E\n  xhr.\u003Cspan class=\"hljs-title function_\"\u003EaddEventListener\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-string\"\u003E&#x27;readystatechange&#x27;\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003Ee\u003C\u002Fspan\u003E) {\n    \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (e.\u003Cspan class=\"hljs-property\"\u003Etarget\u003C\u002Fspan\u003E.\u003Cspan class=\"hljs-property\"\u003EreadyState\u003C\u002Fspan\u003E === \u003Cspan class=\"hljs-number\"\u003E4\u003C\u002Fspan\u003E &amp;&amp; e.\u003Cspan class=\"hljs-property\"\u003Etarget\u003C\u002Fspan\u003E.\u003Cspan class=\"hljs-property\"\u003Estatus\u003C\u002Fspan\u003E === \u003Cspan class=\"hljs-number\"\u003E200\u003C\u002Fspan\u003E) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F....\u003C\u002Fspan\u003E\n\n    } \u003Cspan class=\"hljs-keyword\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-keyword\"\u003Eif\u003C\u002Fspan\u003E (e.\u003Cspan class=\"hljs-property\"\u003Etarget\u003C\u002Fspan\u003E.\u003Cspan class=\"hljs-property\"\u003EreadyState\u003C\u002Fspan\u003E === \u003Cspan class=\"hljs-number\"\u003E4\u003C\u002Fspan\u003E) {\n      \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F....\u003C\u002Fspan\u003E\n    }\n  });\n  xhr.\u003Cspan class=\"hljs-title function_\"\u003EsetRequestHeader\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-string\"\u003E&quot;Content-Type&quot;\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-string\"\u003E&quot;application\u002Fjson&quot;\u003C\u002Fspan\u003E);\n  xhr.\u003Cspan class=\"hljs-title function_\"\u003Esend\u003C\u002Fspan\u003E();\n\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 id=\"參考資料\" title=\"參考資料\"\u003E\u003Ca href=\"#參考資料\"\u003E參考資料\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca  href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fzh-TW\u002Fdocs\u002FWeb\u002FHTTP\u002FCORS\" target=\"_blank\" rel=\"noreferrer noopener\"\u003EMDN 跨來源資源共享（CORS）\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca  href=\"https:\u002F\u002Fithelp.ithome.com.tw\u002Farticles\u002F10205069\" target=\"_blank\" rel=\"noreferrer noopener\"\u003EWeb Server - 跨域請求\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n",toc:{title:b,subtitles:["參考資料"]},wordCount:261}}}}(null,"同源政策 Same-Origin Policy","2025-02-17T00:00:00.000Z"));