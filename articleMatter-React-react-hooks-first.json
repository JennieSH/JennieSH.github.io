{"info":{"title":"[Note] React Hooks æ•´ç†","fileName":"react-hooks-first","description":"æœ€è¿‘é–‹å§‹å­¸ç¿’ React Hooksï¼Œè¶é€™æ¬¡æ©Ÿæœƒæ•´ç†å¸¸è¦‹çš„ Hooksï¼Œå…§å®¹æ…¢æ…¢å¢åŠ ä¸­ï¼","createdAt":"2021-12-08T00:00:00.000Z","updatedAt":"2021-12-08T00:00:00.000Z","tags":["React","React Hooks"]},"content":"<h6>tags: <code>React</code>ã€<code>React Hooks</code></h6>\n<h1 id=\"[Note] React Hooks æ•´ç†\" title=\"[Note] React Hooks æ•´ç†\">[Note] React Hooks æ•´ç†</h1>\n<p>æœ€è¿‘é–‹å§‹å­¸ç¿’ React Hooksï¼Œè¶é€™æ¬¡æ©Ÿæœƒæ•´ç†å¸¸è¦‹çš„ Hooksï¼Œç›®å‰å°šç¼ºå…©å€‹é¡å¤– Hooks æ•´ç† (<a  href=\"https://zh-hant.reactjs.org/docs/hooks-reference.html#useimperativehandle\" target=\"_blank\" rel=\"noreferrer noopener\"><code>useImperativeHandle</code></a> &amp; <a  href=\"https://zh-hant.reactjs.org/docs/hooks-reference.html#usedebugvalue\" target=\"_blank\" rel=\"noreferrer noopener\"><code>useDebugValue</code></a>)ï¼Œå…§å®¹æ…¢æ…¢å¢åŠ ä¸­ ğŸƒ</p>\n<h2 id=\"Why Hook?\" title=\"Why Hook?\"><a href=\"#Why Hook?\">Why Hook?</a></h2>\n<ul>\n<li>æ›´æ–¹ä¾¿åœ¨ component ä¹‹é–“å…±ç”¨ stateful çš„é‚è¼¯</li>\n<li>è§£æ±º lifecycle æ–¹æ³•å¸¸å¸¸å°‡ä¸ç›¸é—œçš„é‚è¼¯æ··åˆåœ¨ä¸€èµ· e.g. event listener å’ŒæŠ“å–è³‡æ–™è¨­ç½®åœ¨åŒå€‹ <code>componentDidMount</code></li>\n<li>é™ä½åˆå­¸è€…å­¸ç¿’é–€æª»ï¼Œclass éœ€è¦è¨˜å¾—ç¶å®šå’Œäº‹å…ˆäº†è§£ <code>this</code> åœ¨ JavaScript ä¸­å¦‚ä½•é‹ä½œ</li>\n</ul>\n<h2 id=\"Hook é€šç”¨è¦å‰‡\" title=\"Hook é€šç”¨è¦å‰‡\"><a href=\"#Hook é€šç”¨è¦å‰‡\">Hook é€šç”¨è¦å‰‡</a></h2>\n<ul>\n<li>åªåœ¨ <strong>React function componen</strong>t æˆ–<strong>è‡ªå®šç¾©çš„ Hook</strong> å‘¼å« Hook</li>\n<li>åªåœ¨<strong>æœ€ä¸Šå±¤</strong>å‘¼å« Hookï¼šä¸è¦åœ¨è¿´åœˆã€åˆ¤æ–·å¼ã€æˆ–æ˜¯åµŒå¥— function ä¸­å‘¼å« Hook</li>\n</ul>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// ğŸš«ï¼š ä¸èƒ½æ”¾å…¥æ¢ä»¶å¼è£¡é¢</span>\n\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">App</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-literal\">true</span>) {\n    <span class=\"hljs-keyword\">const</span> [count, setCount] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-number\">0</span>);\n  }\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">h1</span>&gt;</span>React<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">h1</span>&gt;</span></span>\n  );\n};\n</code></pre>\n<h2 id=\"useState\" title=\"useState\"><a href=\"#useState\">useState</a></h2>\n<h3>ä½¿ç”¨æ–¹æ³•</h3>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// èªæ³•ï¼š const [state, setState] = useState(åˆå§‹å€¼)</span>\n\n<span class=\"hljs-keyword\">const</span> [count, setCount] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-number\">0</span>);\n</code></pre>\n<h3>é‡é»</h3>\n<ul>\n<li>ä½¿ç”¨é™£åˆ—è§£æ§‹è³¦å€¼ï¼Œå›å‚³çš„ç¬¬ä¸€å€‹å€¼ <code>count</code> ç‚ºç•¶å‰çš„ stateï¼Œç¬¬äºŒå€‹å€¼ <code>setCount</code> ç‚ºå¯æ›´æ–° state çš„æ–¹æ³•</li>\n<li><code>setState</code> å¯ç›´æ¥å‚³å€¼ï¼Œä¹Ÿå¯ä»¥å‚³å…¥ function</li>\n</ul>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// å…©ç¨®å¯«æ³•éƒ½æœ‰ç›¸åŒæ•ˆæœï¼Œä¸€æ¨£éƒ½æœƒ +1</span>\n\n<span class=\"hljs-comment\">// å¯«æ³•ä¸€ï¼šç›´æ¥å‚³å€¼</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">increase</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n    <span class=\"hljs-title function_\">setCount</span>(count + <span class=\"hljs-number\">1</span>);\n };\n\n<span class=\"hljs-comment\">// å¯«æ³•äºŒï¼š function å¯æ‹¿åˆ° previous value</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">increase</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n    <span class=\"hljs-title function_\">setCount</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">prevCount</span>)=&gt;</span> prevCount + <span class=\"hljs-number\">1</span>);\n};\n</code></pre>\n<details class='spoiler'><summary>è£œå……</summary>\n<div class=\"info\">\n<p><strong>ğŸ’¡ <code>setState</code> ä½¿ç”¨ function æ™‚æ©Ÿï¼š<br />\nå¦‚æœæ˜¯æœ‰ä½¿ç”¨åˆ° <code>previous value</code> ä¾†è¨­ç½®æ–°çš„ <code>value</code> æˆ–å½¼æ­¤é–“æœ‰ä¾è³´é—œä¿‚ã€‚</strong></p>\n<p>é›–ç„¶ä¸Šé¢å…©å€‹å¯«æ³•éƒ½å¯é”åˆ° <strong>+1</strong>ï¼Œä½†åœ¨ä¸‹é¢çš„ä¾‹å­å°±ä¸é©åˆç›´æ¥å‚³å€¼ï¼š</p>\n<p><code>increase</code> å…§å‘¼å«å…©æ¬¡ <code>setCount</code>ï¼Œç•¶ <code>increase</code> è¢«è§¸ç™¼å¾Œï¼Œæˆ‘å€‘é æœŸ <code>count</code> æœƒç­‰æ–¼ 2ï¼Œä½†å¯¦éš›å¾—åˆ° <strong>1</strong>ã€‚</p>\n<p>å› ç‚º <code>setCount(count + 1)</code>ï¼Œè£¡é¢çš„ <code>count</code> éƒ½é‚„æ˜¯ç•¶å‰ render å€¼ <strong>0</strong>ï¼Œæ‰€ä»¥ç­‰æ–¼åŸ·è¡Œå…©æ¬¡ <code>setCount(0 + 1)</code>ã€‚</p>\n<pre class=\"hljs\"><code><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Count</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [count, setCount] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-number\">0</span>);\n\n  <span class=\"hljs-comment\">// é æœŸç‚º 2ï¼Œä½†å¯¦éš›å¾—åˆ° 1</span>\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">increase</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n    <span class=\"hljs-title function_\">setCount</span>(count + <span class=\"hljs-number\">1</span>); <span class=\"hljs-comment\">// æ­¤æ™‚ count ç‚º 0ï¼Œç›¸ç•¶æ–¼ setCount(0 + 1)</span>\n    <span class=\"hljs-title function_\">setCount</span>(count + <span class=\"hljs-number\">1</span>); <span class=\"hljs-comment\">// æ­¤æ™‚ count ç‚º 0ï¼Œç›¸ç•¶æ–¼ setCount(0 + 1)</span>\n  };\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span>&gt;</span>{count}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{increase}</span>&gt;</span>+<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n  );\n};\n\n</code></pre>\n<p>é€™æ™‚æ”¹ç”¨ function å¯«æ³•ï¼Œ ç¢ºä¿æ˜¯ä½¿ç”¨ <code>count</code> çš„ <code>previous value</code> è€Œä¸æ˜¯ç•¶å‰ render å¾Œçš„å€¼ï¼Œå°±æœƒå¦‚é æœŸå¾—åˆ° <strong>2</strong> :</p>\n<pre class=\"hljs\"><code><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Count</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [count, setCount] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-number\">0</span>);\n\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">increase</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n    <span class=\"hljs-title function_\">setCount</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">prevCount</span> =&gt;</span> prevCount + <span class=\"hljs-number\">1</span>); <span class=\"hljs-comment\">// ç›¸ç•¶æ–¼ setCount(0 + 1)</span>\n    <span class=\"hljs-title function_\">setCount</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">prevCount</span> =&gt;</span> prevCount + <span class=\"hljs-number\">1</span>); <span class=\"hljs-comment\">// ç›¸ç•¶æ–¼ setCount(1 + 1)</span>\n  };\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span>&gt;</span>{count}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{increase}</span>&gt;</span>+<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n  );\n};\n</code></pre>\n</div>\n</details>\n<br/>\n<ul>\n<li>åˆå§‹å€¼æœ‰å…©ç¨®è¡¨ç¤ºæ–¹å¼ï¼Œå¯ç›´æ¥å‚³å…¥å€¼ï¼Œä¹Ÿå¯ä»¥ç”¨ function</li>\n</ul>\n<details class='spoiler'><summary>è£œå……</summary>\n<div class=\"info\">\n<p>ğŸ’¡ <strong>åˆå§‹å€¼ä½¿ç”¨ function å¯«æ³•çš„æ™‚æ©Ÿï¼š</strong></p>\n<p>å› ç‚ºæ¯æ¬¡ render æ™‚å€™éƒ½æœƒé‡æ–°åŸ·è¡Œ <code>useSate</code>ï¼Œå¦‚æœ<strong>åˆå§‹å€¼æ˜¯éœ€è¦éå¸¸è¤‡é›œè¨ˆç®—æ™‚</strong>ï¼Œæ¯æ¬¡æ›´æ–°éœ€è¦é‡æ–°è¨ˆç®—ï¼Œå°±æœƒé™ä½æ•ˆèƒ½ï¼Œé€™æ™‚å°±éœ€è¦å‚³å…¥ functionï¼Œ<strong>è©² function åªæœƒåœ¨åˆå§‹ render æ™‚è¢«èª¿ç”¨</strong>ã€‚</p>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// ç›´æ¥å‚³å€¼ï¼š</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">complexCompute</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;execution&quot;</span>);\n <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;\n};\n\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Count</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n <span class=\"hljs-comment\">// æ¯æ¬¡æŒ‰ +1 æ™‚ï¼Œéƒ½æœƒå°å‡º â€˜executionâ€™</span>\n <span class=\"hljs-keyword\">const</span> [count, setCount] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-title function_\">complexCompute</span>());\n\n <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">increase</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n   <span class=\"hljs-title function_\">setCount</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">preCount</span> =&gt;</span> preCount + <span class=\"hljs-number\">1</span>);\n };\n\n <span class=\"hljs-keyword\">return</span> (\n   <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n     <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span>&gt;</span>{count}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n     <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{increase}</span>&gt;</span>+<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n   <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n );\n};\n</code></pre>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// æ”¹ç”¨ function</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Count</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-comment\">// é¦–æ¬¡æ¸²æŸ“å°å‡º â€˜executionâ€™ï¼Œå¾ŒçºŒæŒ‰ +1 æ™‚ï¼Œä¸æœƒåœ¨å°å‡ºå­—äº†</span>\n  <span class=\"hljs-keyword\">const</span> [count, setCount] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title function_\">complexCompute</span>());\n\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">increase</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n    <span class=\"hljs-title function_\">setCount</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">preCount</span> =&gt;</span> preCount + <span class=\"hljs-number\">1</span>);\n  };\n\n    ...\n}\n</code></pre>\n</div>\n</details>\n<br/>\n<ul>\n<li><code>setState</code> æ˜¯å®Œå…¨è¦†è“‹ stateï¼Œè€Œé merge</li>\n</ul>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// ç›´æ¥æ•´å€‹è¦†å¯« fruitDate</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Fruit</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [fruitDate, setFruitDate] = <span class=\"hljs-title function_\">useState</span>({ <span class=\"hljs-attr\">amount</span>: <span class=\"hljs-number\">1</span>, <span class=\"hljs-attr\">fruit</span>: <span class=\"hljs-string\">&quot;banana&quot;</span> });\n\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">change</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n    <span class=\"hljs-title function_\">setFruitDate</span>({ <span class=\"hljs-attr\">fruit</span>: <span class=\"hljs-string\">&quot;apple&quot;</span> }); <span class=\"hljs-comment\">// è§¸ç™¼å¾Œï¼ŒfruitDate ç‚º { fruit: &quot;apple&quot; }</span>\n  };\n\n  <span class=\"hljs-keyword\">return</span> <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{change}</span>&gt;</span>change fruit<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span></span>\n};\n</code></pre>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// ä½¿ç”¨æ“´å±•é‹ç®—å­ï¼Œä¿ç•™ç‰©ä»¶å…§å…¶ä»–å±¬æ€§</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Fruit</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [fruitDate, setFruitDate] = <span class=\"hljs-title function_\">useState</span>({ <span class=\"hljs-attr\">amount</span>: <span class=\"hljs-number\">1</span>, <span class=\"hljs-attr\">fruit</span>: <span class=\"hljs-string\">&quot;banana&quot;</span> });\n\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">change</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n    <span class=\"hljs-title function_\">setFruitDate</span>({ ...fruitData, <span class=\"hljs-attr\">fruit</span>: <span class=\"hljs-string\">&quot;apple&quot;</span> }); <span class=\"hljs-comment\">// è§¸ç™¼å¾Œï¼ŒfruitDate ç‚º { amount: 1 fruit: &quot;apple&quot; }</span>\n  };\n\n  ...\n};\n</code></pre>\n<h2 id=\"useEffect\" title=\"useEffect\"><a href=\"#useEffect\">useEffect</a></h2>\n<h3>ä½¿ç”¨æ–¹æ³•</h3>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// èªæ³•ï¼š useEffect(()=&gt;{},[ä¾è³´é …])</span>\n\n<span class=\"hljs-title function_\">useEffect</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-comment\">// æ¯æ¬¡ç•«é¢é‡æ–°æ¸²æŸ“å¾Œéƒ½æœƒåŸ·è¡Œ</span>\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;executed&quot;</span>)\n});\n</code></pre>\n<h3>é‡é»</h3>\n<ul>\n<li>è™•ç† side effect äº‹ä»¶ï¼Œe.g. ajaxã€EventLister</li>\n<li>DOM æ”¹è®Š =&gt; æ¸²æŸ“ç•«é¢ =&gt; èª¿ç”¨ <code>useEffect</code></li>\n<li>å¯ä»¥æœ‰å¤šå€‹ä¾è³´é …ï¼Œçš†æ”¾åœ¨é™£åˆ—ä¸­ <code>useEffect(()=&gt;{ ... },[a, b, c])</code></li>\n<li>æ­é…ç¬¬äºŒåƒæ•¸å‚³å…¥ä¾è³´å’Œ return functionï¼Œå¯é”åˆ°åŸå…ˆ React ç”Ÿå‘½é€±æœŸ <code>componentDidMount</code>ã€<code>componentDidUpdate</code> å’Œ <code>componentWillUnmount</code> çš„æ•ˆæœ</li>\n</ul>\n<pre class=\"hljs\"><code><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Fruit</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [fruit, setFruit] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-string\">&quot;banana&quot;</span>);\n  <span class=\"hljs-keyword\">const</span> [count, setCount] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-number\">0</span>);\n\n  <span class=\"hljs-comment\">// A. ç¬¬äºŒåƒæ•¸ä¸å¸¶å…¥ï¼Œæ¯æ¬¡ç•«é¢é‡æ–°æ¸²æŸ“ï¼Œéƒ½æœƒåŸ·è¡Œ</span>\n  <span class=\"hljs-title function_\">useEffect</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-comment\">// ç•¶ fruit æˆ– count å€¼æ”¹è®Šï¼Œç•«é¢é‡æ–°æ¸²æŸ“ï¼Œéƒ½æœƒå°å‡º â€œchangedâ€</span>\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;changed&quot;</span>);\n  });\n\n\n  <span class=\"hljs-comment\">// B. ç¬¬äºŒåƒæ•¸ï¼Œå‚³å…¥ç©ºé™£åˆ— []ï¼Œåªæœ‰åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ™‚åŸ·è¡Œ</span>\n  <span class=\"hljs-title function_\">useEffect</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-comment\">// åªåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æœƒå°å‡º &quot;init&quot;</span>\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;init&quot;</span>);\n  }, []);\n\n\n  <span class=\"hljs-comment\">// C. ç¬¬äºŒåƒæ•¸ï¼Œå‚³å…¥ä¾è³´é …ï¼Œåªæœ‰åœ¨ä¾è³´é …æ”¹è®Šæ™‚æ‰åŸ·è¡Œ</span>\n  <span class=\"hljs-title function_\">useEffect</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-comment\">// åªæœ‰ count å€¼æ”¹è®Šï¼Œç•«é¢æ›´æ–°ï¼Œæ‰æœƒå°å‡º &quot;count changed&quot;</span>\n    <span class=\"hljs-comment\">// å¦‚æœæ˜¯ fruit å€¼æ”¹è®Šå‰‡ä¸è§¸ç™¼</span>\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;count changed&quot;</span>);\n  }, [count]);\n\n\n  <span class=\"hljs-comment\">// D. return çš„ function æœƒåœ¨çµ„ä»¶ç§»é™¤å¾Œæœƒè§¸ç™¼</span>\n  <span class=\"hljs-title function_\">useEffect</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-comment\">// åˆæ¬¡æ¸²æŸ“æ™‚ï¼Œå»ºç«‹ setInterval</span>\n    <span class=\"hljs-keyword\">const</span> timer = <span class=\"hljs-built_in\">setInterval</span>(<span class=\"hljs-function\">() =&gt;</span> {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;hello world&quot;</span>);\n    }, <span class=\"hljs-number\">1000</span>);\n\n    <span class=\"hljs-comment\">// åœ¨çµ„ä»¶ç§»é™¤å¾ŒæœƒåŸ·è¡Œ clearInterval</span>\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-built_in\">clearInterval</span>(timer);\n  }, []);\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{()</span> =&gt;</span> setFruit(&quot;apple&quot;)}&gt;change fruit - {fruit}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>;\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{()</span> =&gt;</span> setCount(prev =&gt; prev + 1)}&gt;increase count - {count}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>;\n    <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n  );\n};\n</code></pre>\n<h2 id=\"useLayoutEffect\" title=\"useLayoutEffect\"><a href=\"#useLayoutEffect\">useLayoutEffect</a></h2>\n<h3>ä½¿ç”¨æ–¹æ³•</h3>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// èªæ³•ï¼š useLayoutEffect(()=&gt;{},[ä¾è³´é …])</span>\n\n<span class=\"hljs-title function_\">useLayoutEffect</span>(<span class=\"hljs-function\">() =&gt;</span> {\n     <span class=\"hljs-comment\">// æ¯æ¬¡ç•«é¢é‡æ–°æ¸²æŸ“å‰éƒ½æœƒåŸ·è¡Œ</span>\n     <span class=\"hljs-comment\">// å° DOM æ“ä½œ ....</span>\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;executed&quot;</span>)\n});\n</code></pre>\n<h3>é‡é»</h3>\n<ul>\n<li>DOM æ”¹è®Š =&gt; èª¿ç”¨ <code>useLayoutEffect</code> =&gt; æ¸²æŸ“ç•«é¢</li>\n<li>è¬¹æ…ä½¿ç”¨ï¼Œæœƒå½±éŸ¿ä½¿ç”¨è€…é«”é©—ï¼Œå› ç‚ºéœ€è¦ç­‰å¾… <code>useLayoutEffect</code> å…§ç¨‹å¼å¯¦è¡Œå®Œï¼Œæ‰æœƒæ¸²æŸ“å‡ºç•«é¢</li>\n<li>ä½¿ç”¨æ™‚æ©Ÿï¼šéœ€è¦åŸºæ–¼ DOM çš„ Layout åšé¡å¤–æ“ä½œ e.g. æ¸¬é‡ DOM</li>\n</ul>\n<h3>ç¯„ä¾‹ (useEffect v.s. useLayoutEffect)</h3>\n<h4>- ä½¿ç”¨ useEffect</h4>\n<p>åœ¨æ…¢å‹•ä½œçš„ gif è£¡é¢å¯ä»¥çœ‹åˆ°ä¸€é–‹å§‹çš„ <code>hi</code> (<code>top: 0</code>) å…ˆå‡ºç¾åœ¨æŒ‰éˆ•æ—é‚Šï¼Œåœ¨ä¸‹ä¸€å€‹ç•«é¢æ‰å¥—ç”¨ <code>top: 100px</code>ï¼Œå¦‚æœç”¨æ­£å¸¸é€Ÿåº¦çœ‹ï¼Œå°±æœƒçœ‹åˆ°ç¬¬ä¸€å€‹ hi æœƒé–ƒçˆä¸€ä¸‹ï¼Œé€™å°ä½¿ç”¨è€…é«”é©—å¾ˆä¸å¥½ã€‚</p>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// ä½¿ç”¨ useEffect</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Foo</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [show, setShow] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-literal\">false</span>);\n  <span class=\"hljs-keyword\">const</span> greetRef = <span class=\"hljs-title function_\">useRef</span>(<span class=\"hljs-literal\">null</span>);\n\n  <span class=\"hljs-title function_\">useEffect</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-keyword\">if</span> (greetRef.<span class=\"hljs-property\">current</span> === <span class=\"hljs-literal\">null</span>) <span class=\"hljs-keyword\">return</span>;\n\n    (greetRef.<span class=\"hljs-property\">current</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-title class_\">HTMLSpanElement</span>).<span class=\"hljs-property\">style</span>.<span class=\"hljs-property\">top</span> = <span class=\"hljs-string\">&quot;100px&quot;</span>;\n  }, [show]);\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{()</span> =&gt;</span> setShow(prev =&gt; !prev)}&gt; toggle Button<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n      {show &amp;&amp; (\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span> <span class=\"hljs-attr\">ref</span>=<span class=\"hljs-string\">{greetRef}</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{{</span> <span class=\"hljs-attr\">position:</span> &quot;<span class=\"hljs-attr\">absolute</span>&quot; }}&gt;</span>\n          hi\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n      )}\n    <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n  );\n};\n</code></pre>\n<p><img src=\"https://i.imgur.com/gGzLETq.gif\" alt=\"useEffect\" /></p>\n<h4>- ä½¿ç”¨ useLayoutEffect</h4>\n<p>å› ç‚ºåœ¨æ¸²æŸ“ç•«é¢å‰ï¼Œå…ˆåŸ·è¡Œå®Œå¥½ <code>hi</code> çš„ <code>top: 100px</code>ï¼Œæ‰€ä»¥åœ¨çœ‹åˆ°ç•«é¢æ™‚ï¼Œå·²ç¶“æ‰€è¨­å®šçš„ä½ç½®ä¸Šäº†ã€‚</p>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// ä½¿ç”¨ useLayoutEffect</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Foo</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [show, setShow] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-literal\">false</span>);\n  <span class=\"hljs-keyword\">const</span> greetRef = <span class=\"hljs-title function_\">useRef</span>(<span class=\"hljs-literal\">null</span>);\n\n  <span class=\"hljs-title function_\">useLayoutEffect</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-keyword\">if</span> (greetRef.<span class=\"hljs-property\">current</span> === <span class=\"hljs-literal\">null</span>) <span class=\"hljs-keyword\">return</span>;\n\n    (greetRef.<span class=\"hljs-property\">current</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-title class_\">HTMLSpanElement</span>).<span class=\"hljs-property\">style</span>.<span class=\"hljs-property\">top</span> = <span class=\"hljs-string\">&quot;100px&quot;</span>;\n  }, [show]);\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{()</span> =&gt;</span> setShow(prev =&gt; !prev)}&gt; toggle Button<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n      {show &amp;&amp; (\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span> <span class=\"hljs-attr\">ref</span>=<span class=\"hljs-string\">{greetRef}</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{{</span> <span class=\"hljs-attr\">position:</span> &quot;<span class=\"hljs-attr\">absolute</span>&quot; }}&gt;</span>\n          hi\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n      )}\n    <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n  );\n};\n</code></pre>\n<p><img src=\"https://i.imgur.com/k5IHSoW.gif\" alt=\"useLayoutEffect\" /></p>\n<h2 id=\"useMemo\" title=\"useMemo\"><a href=\"#useMemo\">useMemo</a></h2>\n<h3>ä½¿ç”¨æ–¹æ³•</h3>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// èªæ³•ï¼š const data = useMemo(()=&gt;{ return å€¼ },[ä¾è³´é …])</span>\n\n<span class=\"hljs-keyword\">const</span> memoizedValue = <span class=\"hljs-title function_\">useMemo</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title function_\">computeExpensiveValue</span>(a, b), [a, b]);\n</code></pre>\n<ul>\n<li>å¯ä»¥å°‡<strong>å‡½å¼è¿”å›å€¼ cached</strong>ï¼ˆè·Ÿ Vue çš„ computed å¾ˆåƒ)ï¼Œä¸¦å›å‚³ä¸€å€‹ <a  href=\"https://en.wikipedia.org/wiki/Memoization\" target=\"_blank\" rel=\"noreferrer noopener\">memoized</a> çš„å€¼</li>\n<li>useMemo çš„ function æœƒåœ¨ render æœŸé–“åŸ·è¡Œ</li>\n<li>å¯å‚³å…¥ä¾è³´ arrayï¼Œç•¶ä¾è³´æ”¹è®Šæ™‚æ‰é‡æ–°è¨ˆç®—ï¼Œä¸æä¾›å‰‡æ¯æ¬¡éƒ½è¨ˆç®—</li>\n<li>éœ€é¡å¤–è¨˜æ†¶é«”å„²å­˜è®Šæ•¸ï¼Œç›¸ç•¶æ–¼ä»¥ç©ºé–“æ›æ™‚é–“ï¼Œæ‰€ä»¥ç°¡å–®çš„è¨ˆç®— / å€¼ï¼Œè¦é¿å…æ¿«ç”¨</li>\n<li>ä½¿ç”¨æƒ…å¢ƒï¼šç•¶å€¼éœ€è¦æ˜‚è²´è¨ˆç®—å¾—åˆ°ï¼Œä½†ä¸éœ€è¦æ¯æ¬¡ render éƒ½é€²è¡Œé‡æ–°è¨ˆç®—ï¼Œå¯ä½¿ç”¨ useMemo ä¾†å„ªåŒ–</li>\n</ul>\n<h3>ç¯„ä¾‹</h3>\n<p>ç”±æ–¼æ¯æ¬¡ç•«é¢æ›´æ–°æ¸²æŸ“éƒ½æœƒåŸ·è¡Œ <code>slowFunc</code>ï¼Œå³ä½¿æˆ‘å€‘åªæƒ³ toggle theme æ™‚ï¼Œé‚„æ˜¯è¦ç­‰å¾… for è¿´åœˆçµæŸï¼Œå°è‡´ dark theme çš„ç•«é¢æ›´æ–°æœƒæœ‰å»¶é²ã€‚</p>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// æ¨¡æ“¬è¤‡é›œè¨ˆç®—</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">slowFunc</span> = (<span class=\"hljs-params\">num</span>) =&gt; {\n  <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">let</span> i = <span class=\"hljs-number\">0</span>; i &lt;= <span class=\"hljs-number\">1000000000</span>; i++) {}\n  <span class=\"hljs-keyword\">return</span> num * <span class=\"hljs-number\">2</span>;\n};\n\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Fruit</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [num, setNumber] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-number\">0</span>);\n  <span class=\"hljs-keyword\">const</span> [dark, setDark] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-literal\">false</span>);\n  <span class=\"hljs-keyword\">const</span> doubleNumber = <span class=\"hljs-title function_\">slowFunc</span>(num); <span class=\"hljs-comment\">// æ¯æ¬¡æ¸²æŸ“éƒ½æœƒåŸ·è¡Œ</span>\n  <span class=\"hljs-keyword\">const</span> theme = {\n    <span class=\"hljs-attr\">color</span>: dark ? <span class=\"hljs-string\">&quot;white&quot;</span> : <span class=\"hljs-string\">&quot;black&quot;</span>,\n    <span class=\"hljs-attr\">backgroundColor</span>: dark ? <span class=\"hljs-string\">&quot;black&quot;</span> : <span class=\"hljs-string\">&quot;white&quot;</span>\n  };\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;number&quot;</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">{num}</span> <span class=\"hljs-attr\">onChange</span>=<span class=\"hljs-string\">{e</span> =&gt;</span> setNumber(parseInt(e.target.value))} /&gt;\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span>&gt;</span>{doubleNumber}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{()</span> =&gt;</span> setDark(!dark)} style={theme}&gt;\n        toggle theme\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n  );\n};\n</code></pre>\n<p>ä½¿ç”¨ useMemo æ”¹å¯«ä¸¦æŒ‡å®šä¾è³´å¾Œï¼Œåœ¨ toggle theme å°±ä¸æœƒå†é€²å…¥ for è¿´åœˆï¼Œèƒ½åŠæ™‚è®Šæ›´é¡è‰²äº†</p>\n<pre class=\"hljs\"><code><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">slowFunc</span> = (<span class=\"hljs-params\">num</span>) =&gt; {\n  <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">let</span> i = <span class=\"hljs-number\">0</span>; i &lt;= <span class=\"hljs-number\">1000000000</span>; i++) {}\n  <span class=\"hljs-keyword\">return</span> num * <span class=\"hljs-number\">2</span>;\n};\n\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Fruit</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [num, setNumber] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-number\">0</span>);\n  <span class=\"hljs-keyword\">const</span> [dark, setDark] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-literal\">false</span>);\n  <span class=\"hljs-comment\">// æŒ‡å®š num ç‚ºä¾è³´çš„å€¼ï¼Œåªæœ‰ num æ”¹è®Šå€¼ï¼Œæ‰å‘¼å« slowFunc</span>\n  <span class=\"hljs-keyword\">const</span> doubleNumber = <span class=\"hljs-title function_\">useMemo</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title function_\">slowFunc</span>(num), [num]);\n  <span class=\"hljs-keyword\">const</span> theme = {\n    <span class=\"hljs-attr\">color</span>: dark ? <span class=\"hljs-string\">&quot;white&quot;</span> : <span class=\"hljs-string\">&quot;black&quot;</span>,\n    <span class=\"hljs-attr\">backgroundColor</span>: dark ? <span class=\"hljs-string\">&quot;black&quot;</span> : <span class=\"hljs-string\">&quot;white&quot;</span>\n  };\n\n  <span class=\"hljs-keyword\">return</span> (...);\n};\n</code></pre>\n<h2 id=\"useCallback\" title=\"useCallback\"><a href=\"#useCallback\">useCallback</a></h2>\n<h3>ä½¿ç”¨æ–¹æ³•</h3>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// èªæ³•ï¼š const cb = useCallback(callback, [ä¾è³´é …])</span>\n\n<span class=\"hljs-keyword\">const</span> memoizedCallback = <span class=\"hljs-title function_\">useCallback</span>(\n  <span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-title function_\">doSomething</span>(a, b);\n  },\n  [a, b],\n);\n</code></pre>\n<ul>\n<li>èˆ‡ <code>useMemo</code> æ¦‚å¿µå¤§è‡´ç›¸åŒï¼Œ<strong><code>useMemo</code></strong> å„²å­˜ function <strong>return å›ä¾†çš„å€¼</strong>ï¼Œ<strong><code>useCallback</code></strong> å„²å­˜<strong>æ•´å€‹ function</strong>ï¼Œ<code>useCallback(fn, deps)</code> ç›¸ç­‰æ–¼ <code>useMemo(() =&gt; fn, deps)</code></li>\n<li>å¯å‚³å…¥ä¾è³´ arrayï¼Œç•¶ä¾è³´æ”¹è®Šæ™‚æ‰é‡æ–°å®£å‘Šè·Ÿå»ºç«‹ function</li>\n<li>ä½¿ç”¨æƒ…å¢ƒï¼šç•¶å­çµ„ä»¶æœ‰ä¾è³´çˆ¶çµ„ä»¶å‚³é functionï¼Œçˆ¶çµ„ä»¶çš„ function å¯ä½¿ç”¨ <code>useCallback</code> å„ªåŒ–ï¼Œä¾†é˜²æ­¢ä¸å¿…è¦çš„ render</li>\n</ul>\n<h3>ç¯„ä¾‹</h3>\n<p>ç•¶æ¯æ¬¡ Parent Component(<code>&lt;Foo&gt;</code>)çš„ <code>num</code> æˆ– <code>dark</code> å€¼è®Šå‹•æ™‚ï¼Œ ç•«é¢æœƒé‡æ–°æ¸²æŸ“ï¼Œ<code>&lt;Foo&gt;</code> å…§çš„ <code>getItems</code> ä¹Ÿè·Ÿè‘—è¢«é‡æ–°å®£å‘Šè·Ÿå»ºç«‹ï¼Œç­‰æ–¼ Child Component(<code>&lt;List&gt;</code>) æ¯æ¬¡æ¥æ”¶ä¸åŒçš„ <code>getItems</code>ï¼Œä¹Ÿè·Ÿè‘—é‡æ–°æ¸²æŸ“ï¼ˆå³ä½¿å€¼ä¸è®Šï¼Œåªæœ‰ <code>dark</code> è®Šå‹•çš„æƒ…å¢ƒï¼‰ã€‚</p>\n<h4>- ä¸ä½¿ç”¨ useCallback</h4>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// Child Component</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">List</span> = (<span class=\"hljs-params\">{ getItems }</span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [items, setItems] = <span class=\"hljs-title function_\">useState</span>([]);\n\n  <span class=\"hljs-title function_\">useEffect</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-title function_\">setItems</span>(<span class=\"hljs-title function_\">getItems</span>());\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;executed&quot;</span>); <span class=\"hljs-comment\">// num æˆ– dark å€¼è®Šå‹•æ™‚ï¼Œ&lt;List&gt; éƒ½æœƒ rerenderï¼Œå°å‡º executed</span>\n  }, [getItems]);\n\n  <span class=\"hljs-keyword\">return</span> items.<span class=\"hljs-title function_\">map</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">item</span> =&gt;</span> <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">key</span>=<span class=\"hljs-string\">{item}</span>&gt;</span>{item}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span>);\n};\n\n<span class=\"hljs-comment\">// Parent Component</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Foo</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [num, setNumber] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-number\">1</span>);\n  <span class=\"hljs-keyword\">const</span> [dark, setDark] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-literal\">false</span>);\n\n  <span class=\"hljs-comment\">// ä¸€èˆ¬å®£å‘Šå‡½å¼</span>\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">getItems</span> = (<span class=\"hljs-params\"></span>) =&gt; [num, num + <span class=\"hljs-number\">1</span>, num + <span class=\"hljs-number\">2</span>];\n\n  <span class=\"hljs-keyword\">const</span> theme = {\n    <span class=\"hljs-attr\">color</span>: dark ? <span class=\"hljs-string\">&quot;white&quot;</span> : <span class=\"hljs-string\">&quot;black&quot;</span>,\n    <span class=\"hljs-attr\">backgroundColor</span>: dark ? <span class=\"hljs-string\">&quot;black&quot;</span> : <span class=\"hljs-string\">&quot;white&quot;</span>\n  };\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;number&quot;</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">{num}</span> <span class=\"hljs-attr\">onChange</span>=<span class=\"hljs-string\">{e</span> =&gt;</span> setNumber(parseInt(e.target.value))} /&gt;\n\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{()</span> =&gt;</span> setDark(prev =&gt; !prev)} style={theme}&gt;\n        toggle theme\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">List</span> <span class=\"hljs-attr\">getItems</span>=<span class=\"hljs-string\">{getItems}</span> /&gt;</span>\n    <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n  );\n};\n</code></pre>\n<h4>- ä½¿ç”¨ useCallback</h4>\n<p>ä½¿ç”¨ useCallbackï¼Œä¸¦å‚³å…¥ <code>num</code> ç•¶ä½œä¾è³´é …ï¼Œæ¥ä¸‹ä¾†ç•¶ <code>num</code> å€¼æ”¹è®Šæ™‚ï¼Œ<code>getItems</code> é€™å€‹ function æ‰æœƒé‡æ–°è¢«å»ºç«‹ã€‚</p>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// Child Component</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">List</span> = (<span class=\"hljs-params\">{ getItems }: { getItems: () =&gt; number[] }</span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [items, setItems] = useState&lt;number[]&gt;([]);\n\n  <span class=\"hljs-title function_\">useEffect</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-title function_\">setItems</span>(<span class=\"hljs-title function_\">getItems</span>());\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;executed&quot;</span>); <span class=\"hljs-comment\">// åªæœ‰åœ¨ num å€¼è®Šå‹•æ™‚ï¼Œæ‰å°å‡º executed</span>\n  }, [getItems]);\n\n  <span class=\"hljs-keyword\">return</span> items.<span class=\"hljs-title function_\">map</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">item</span> =&gt;</span> <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">key</span>=<span class=\"hljs-string\">{item}</span>&gt;</span>{item}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span>);\n};\n\n<span class=\"hljs-comment\">// Parent Component</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Foo</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [num, setNumber] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-number\">1</span>);\n  <span class=\"hljs-keyword\">const</span> [dark, setDark] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-literal\">false</span>);\n\n  <span class=\"hljs-comment\">// ä½¿ç”¨ useCallback</span>\n  <span class=\"hljs-keyword\">const</span> getItems = <span class=\"hljs-title function_\">useCallback</span>(<span class=\"hljs-function\">() =&gt;</span> [num, num + <span class=\"hljs-number\">1</span>, num + <span class=\"hljs-number\">2</span>], [num]);\n\n  <span class=\"hljs-keyword\">const</span> theme = { ... };\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;number&quot;</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">{num}</span> <span class=\"hljs-attr\">onChange</span>=<span class=\"hljs-string\">{e</span> =&gt;</span> setNumber(parseInt(e.target.value))} /&gt;\n\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{()</span> =&gt;</span> setDark(prev =&gt; !prev)} style={theme}&gt;\n        toggle theme\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">List</span> <span class=\"hljs-attr\">getItems</span>=<span class=\"hljs-string\">{getItems}</span> /&gt;</span>\n    <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n  );\n};\n\n</code></pre>\n<h2 id=\"useRef\" title=\"useRef\"><a href=\"#useRef\">useRef</a></h2>\n<h3>ä½¿ç”¨æ–¹æ³•</h3>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// èªæ³•ï¼š const refContainer = useRef(åˆå§‹å€¼);</span>\n\n<span class=\"hljs-keyword\">const</span> refCount = <span class=\"hljs-title function_\">useRef</span>(<span class=\"hljs-number\">0</span>);\n</code></pre>\n<h3>é‡é»</h3>\n<ul>\n<li>å›å‚³ä¸€å€‹ ref objectï¼Œç›¸ç•¶æ–¼ <code>{current: value}</code>ï¼Œæ¯æ¬¡ render æ™‚éƒ½æœƒå›å‚³<strong>åŒä¸€å€‹çš„ ref object</strong>ï¼Œåœ¨ component çš„ç”Ÿå‘½é€±æœŸå°‡ä¿æŒä¸è®Š</li>\n<li><code>.current</code> å€¼æ”¹è®Šå¾Œï¼Œä¸æœƒè§¸ç™¼é‡æ–° render</li>\n<li>ä½¿ç”¨æƒ…å¢ƒï¼š\n<ul>\n<li>å–å¾— dom</li>\n<li>ç´€éŒ„å‰ä¸€æ¬¡ render çš„è³‡æ–™</li>\n</ul>\n</li>\n</ul>\n<h3>ç¯„ä¾‹</h3>\n<h4>æƒ…å¢ƒä¸€ï¼šå–å¾— dom element</h4>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// é»é¸æŒ‰éˆ•å¾Œï¼Œinput æ¡†è¦ focus</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">TextBlock</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-comment\">// step 1: å®£å‘Š inputEl ä¸¦ä½¿ç”¨ useRef</span>\n  <span class=\"hljs-keyword\">const</span> inputEl = <span class=\"hljs-title function_\">useRef</span>(<span class=\"hljs-literal\">null</span>);\n\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">onButtonClick</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(inputEl.<span class=\"hljs-property\">current</span>); <span class=\"hljs-comment\">// &lt;input type=&quot;text&quot;&gt;</span>\n    inputEl.<span class=\"hljs-property\">current</span>.<span class=\"hljs-title function_\">focus</span>();\n  };\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n      // step 2: ä½¿ç”¨ ref ç¶åœ¨æƒ³å–å¾—çš„ dom\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">ref</span>=<span class=\"hljs-string\">{inputEl}</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;text&quot;</span> /&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{onButtonClick}</span>&gt;</span>Focus the input<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n  );\n};\n\n</code></pre>\n<br/>\n<h4>æƒ…å¢ƒäºŒï¼šç´€éŒ„å‰ä¸€æ¬¡ render çš„å€¼ e.g. æƒ³è¨ˆç®—å‡ºç¸½å…± render å¹¾æ¬¡</h4>\n<ul>\n<li>ä½¿ç”¨ useState ğŸš«</li>\n</ul>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// éŒ¯èª¤ç¤ºç¯„(å°è‡´ç„¡çª®è¿´åœˆ)ï¼š ä½¿ç”¨ useState</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Name</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [name, setName] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-string\">&quot;&quot;</span>);\n  <span class=\"hljs-keyword\">const</span> [renderCount, setRenderCount] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-number\">0</span>);\n\n  <span class=\"hljs-title function_\">useEffect</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-comment\">// åœ¨ useEffect ä½¿ç”¨ setRenderCount æ›´æ–° renderCount</span>\n    <span class=\"hljs-comment\">// æœƒé€ æˆç„¡çª®å›åœˆï¼š update state =&gt; compoment rerender =&gt; update state again =&gt; compoment rerender again =&gt; ..... =&gt; infinite loop</span>\n    <span class=\"hljs-title function_\">setRenderCount</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">prevCount</span> =&gt;</span> prevCount + <span class=\"hljs-number\">1</span>);\n  });\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">{name}</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;text&quot;</span> <span class=\"hljs-attr\">onChange</span>=<span class=\"hljs-string\">{e</span> =&gt;</span> setName(e.target.value)} /&gt;\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span>&gt;</span>{name}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>It has been rendered {renderCount} times<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n  );\n};\n</code></pre>\n<ul>\n<li>\n<p>ä½¿ç”¨ useRef</p>\n<p>åˆ©ç”¨ <code>.current</code> å€¼æ”¹è®Šå¾Œï¼Œ<strong>ä¸æœƒè§¸ç™¼é‡æ–° render</strong>ï¼Œé€™ä¸€å€‹ç‰¹é»ï¼Œä½¿ç”¨ <code>.current</code> å€¼ä¾†è¨˜éŒ„å’Œæ›´æ–°</p>\n</li>\n</ul>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// ä½¿ç”¨ useRef</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Name</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [name, setName] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-string\">&quot;&quot;</span>);\n  <span class=\"hljs-keyword\">const</span> renderCount = <span class=\"hljs-title function_\">useRef</span>(<span class=\"hljs-number\">0</span>);\n\n  <span class=\"hljs-title function_\">useEffect</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-comment\">// update state =&gt; compoment rerender =&gt; update renderCount.current</span>\n    renderCount.<span class=\"hljs-property\">current</span> += <span class=\"hljs-number\">1</span>;\n  },[name]);\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">{name}</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;text&quot;</span> <span class=\"hljs-attr\">onChange</span>=<span class=\"hljs-string\">{e</span> =&gt;</span> setName(e.target.value)} /&gt;\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span>&gt;</span>{name}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>It has been rendered {renderCount.current} times<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n  );\n};\n</code></pre>\n<p><img src=\"https://i.imgur.com/0XnVYcJ.gif\" alt=\"useRef\" /></p>\n<h2 id=\"useContext\" title=\"useContext\"><a href=\"#useContext\">useContext</a></h2>\n<h3>ä½¿ç”¨æ–¹æ³•</h3>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// èªæ³•ï¼š const value = useContext( è‡ªè¨‚çš„ Context );</span>\n\n<span class=\"hljs-keyword\">const</span> value = <span class=\"hljs-title function_\">useContext</span>(<span class=\"hljs-title class_\">MyContext</span>);\n</code></pre>\n<h3>é‡é»</h3>\n<ul>\n<li>åœ¨ <code>MyContext</code> provider (<code>&lt;MyContext.Provider value={value}&gt;</code>)å…§çš„çµ„ä»¶ï¼Œéƒ½å¯ä»¥é€é <code>useContext</code> å–å¾— <code>MyContext</code> value å€¼</li>\n<li>å¯ä»¥è·¨çµ„ä»¶å–å€¼ï¼Œè§£æ±ºéœ€è¦ç”¨ props ä¸€å±¤å±¤å‚³å€¼ä¸‹å»çš„å•é¡Œ<br />\n(çµ„ä»¶ A â¡ï¸ çµ„ä»¶ B â¡ï¸ çµ„ä»¶ Cï¼ŒC éœ€è¦ A å‚³å…¥çš„ propsï¼Œä½† B å»ä¸éœ€è¦ A å‚³å…¥çš„ props)</li>\n<li>å‘¼å« <code>useContext</code> çš„çµ„ä»¶æœƒåœ¨ context å€¼æ›´æ–°æ™‚é‡æ–°æ¸²æŸ“</li>\n</ul>\n<h3>ç¯„ä¾‹</h3>\n<pre class=\"hljs\"><code><span class=\"hljs-keyword\">const</span> initDarkThemeStatus = <span class=\"hljs-literal\">false</span>;\n<span class=\"hljs-comment\">// Step 1. å…ˆ createContext</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">ThemeContext</span> = <span class=\"hljs-title function_\">createContext</span>(initDarkThemeStatus);\n\n\n\n<span class=\"hljs-comment\">// Child Component</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Child</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-comment\">// Step 3. åœ¨å­çµ„ä»¶ä½¿ç”¨ useContextï¼Œå–å¾— value</span>\n  <span class=\"hljs-keyword\">const</span> darkTheme = <span class=\"hljs-title function_\">useContext</span>(<span class=\"hljs-title class_\">ThemeContext</span>);\n  <span class=\"hljs-keyword\">const</span> theme = {\n    <span class=\"hljs-attr\">color</span>: darkTheme ? <span class=\"hljs-string\">&quot;white&quot;</span> : <span class=\"hljs-string\">&quot;black&quot;</span>,\n    <span class=\"hljs-attr\">backgroundColor</span>: darkTheme ? <span class=\"hljs-string\">&quot;black&quot;</span> : <span class=\"hljs-string\">&quot;white&quot;</span>\n  };\n\n  <span class=\"hljs-keyword\">return</span> <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{theme}</span>&gt;</span>Child Component<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span>;\n};\n\n\n\n<span class=\"hljs-comment\">// Parent Component</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Parent</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">const</span> [darkTheme, setDarkTheme] = <span class=\"hljs-title function_\">useState</span>(initDarkThemeStatus);\n\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">toggleTheme</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n    <span class=\"hljs-title function_\">setDarkTheme</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">prevDarkTheme</span> =&gt;</span> !prevDarkTheme);\n  };\n\n  <span class=\"hljs-keyword\">return</span> (\n      <span class=\"hljs-comment\">// Step 2. åœ¨çˆ¶çµ„ä»¶ä½¿ç”¨ Providerï¼Œä¸¦å‚³å…¥ value</span>\n     <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">ThemeContext.Provider</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">{darkTheme}</span>&gt;</span>\n       <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{toggleTheme}</span>&gt;</span>Toggle Theme<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n       <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Child</span> /&gt;</span>\n     <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">ThemeContext.Provider</span>&gt;</span></span>\n  );\n};\n</code></pre>\n<h2 id=\"useReducer\" title=\"useReducer\"><a href=\"#useReducer\">useReducer</a></h2>\n<h3>ä½¿ç”¨æ–¹æ³•</h3>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// èªæ³•ï¼š const [state, dispatch] = useReducer(reducer, initialArg, init);</span>\n\n<span class=\"hljs-keyword\">const</span> [state, dispatch] = <span class=\"hljs-title function_\">useReducer</span>(reducer, { <span class=\"hljs-attr\">count</span>: <span class=\"hljs-number\">0</span> });\n</code></pre>\n<h3>é‡é»</h3>\n<ul>\n<li>é€²éšç‰ˆçš„ <code>useState</code> (p.s. <a  href=\"https://github.com/facebook/react/blob/5f06576f51ece88d846d01abd2ddd575827c6127/packages/react-reconciler/src/ReactFiberHooks.js#L336\" target=\"_blank\" rel=\"noreferrer noopener\"><code>useState</code></a> åº•å±¤æ˜¯ç”¨ <code>useReducer</code> å¯¦ç¾)</li>\n<li><code>dispatch =&gt; reducer =&gt; state</code>ï¼Œé›†ä¸­åœ¨ <code>reducer</code> åŸ·è¡Œ state ä¿®æ”¹ï¼Œçµ„ä»¶å…§ä¸ç›´æ¥å° state æ“ä½œ</li>\n<li>reducer èˆ‡çµ„ä»¶é–“å‚³åƒæ•¸ï¼š</li>\n</ul>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// çµ„ä»¶ - å‚³ name</span>\n<span class=\"hljs-title function_\">dispatch</span>({ <span class=\"hljs-attr\">type</span>: <span class=\"hljs-variable constant_\">ACTION</span>.<span class=\"hljs-property\">ADD_TODO</span>, <span class=\"hljs-attr\">payload</span>: { name }});\n\n<span class=\"hljs-comment\">// reducer - æ¥æ”¶ name</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">reducer</span> = (<span class=\"hljs-params\">state, action</span>) =&gt; {\n  <span class=\"hljs-keyword\">switch</span> (action.<span class=\"hljs-property\">type</span>) {\n    <span class=\"hljs-keyword\">case</span> <span class=\"hljs-variable constant_\">ACTION</span>.<span class=\"hljs-property\">ADD_TODO</span>:\n      <span class=\"hljs-keyword\">return</span> [...state, <span class=\"hljs-title function_\">newTodo</span>(action.<span class=\"hljs-property\">payload</span>.<span class=\"hljs-property\">name</span>)];\n    ...,\n    <span class=\"hljs-attr\">default</span>:\n      <span class=\"hljs-keyword\">return</span> state;\n  }\n};\n</code></pre>\n<ul>\n<li>å¯å‚³å…¥<a  href=\"https://zh-hant.reactjs.org/docs/hooks-reference.html#lazy-initialization\" target=\"_blank\" rel=\"noreferrer noopener\">ç¬¬ä¸‰å€‹åƒæ•¸(function)</a>\n<ul>\n<li>è¨ˆç®—åˆå§‹ state çš„é‚è¼¯æå–åˆ° reducer å¤–</li>\n<li>æ–¹ä¾¿é‡ç½® state</li>\n</ul>\n</li>\n<li>é©ç”¨<strong>è¤‡é›œçš„ state é‚è¼¯ä¿®æ”¹</strong>æƒ…å¢ƒ e.g. è¨ˆç®—æ©Ÿå¯ä»¥ä½¿ç”¨åŠ æ¸›ä¹˜é™¤ä¿®æ”¹åŸå…ˆçš„å€¼ã€åŒåˆ—è¡¨æ’åº(æ›´æ–°æ™‚é–“ã€å‰µå»ºæ™‚é–“ã€åå­— etc.)</li>\n</ul>\n<h3>ç¯„ä¾‹</h3>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// Todos.jsx</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">ACTION</span> = {\n  <span class=\"hljs-attr\">ADD_TODO</span>: <span class=\"hljs-string\">&quot;add-todo&quot;</span>,\n  <span class=\"hljs-attr\">TOGGLE_TODO</span>: <span class=\"hljs-string\">&quot;toggle_todo&quot;</span>,\n  <span class=\"hljs-attr\">DELETE</span>: <span class=\"hljs-string\">&quot;delete-todo&quot;</span>\n};\n\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">newTodo</span> = name =&gt; {\n  <span class=\"hljs-keyword\">return</span> { <span class=\"hljs-attr\">id</span>: <span class=\"hljs-title class_\">Date</span>.<span class=\"hljs-title function_\">now</span>(), <span class=\"hljs-attr\">name</span>: name, <span class=\"hljs-attr\">complete</span>: <span class=\"hljs-literal\">false</span> };\n};\n\n<span class=\"hljs-comment\">// Step 2. æ’°å¯« reducer</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">reducer</span> = (<span class=\"hljs-params\">state, action</span>) =&gt; {\n  <span class=\"hljs-keyword\">switch</span> (action.<span class=\"hljs-property\">type</span>) {\n    <span class=\"hljs-keyword\">case</span> <span class=\"hljs-variable constant_\">ACTION</span>.<span class=\"hljs-property\">ADD_TODO</span>:\n      <span class=\"hljs-keyword\">return</span> [...state, <span class=\"hljs-title function_\">newTodo</span>(action.<span class=\"hljs-property\">payload</span>.<span class=\"hljs-property\">name</span>)];\n    <span class=\"hljs-keyword\">case</span> <span class=\"hljs-variable constant_\">ACTION</span>.<span class=\"hljs-property\">TOGGLE_TODO</span>:\n      <span class=\"hljs-keyword\">return</span> state.<span class=\"hljs-title function_\">map</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">todo</span> =&gt;</span> {\n        <span class=\"hljs-keyword\">if</span> (todo.<span class=\"hljs-property\">id</span> === action.<span class=\"hljs-property\">payload</span>.<span class=\"hljs-property\">id</span>) <span class=\"hljs-keyword\">return</span> { ...todo, <span class=\"hljs-attr\">complete</span>: !todo.<span class=\"hljs-property\">complete</span> };\n        <span class=\"hljs-keyword\">return</span> todo;\n      });\n    <span class=\"hljs-keyword\">case</span> <span class=\"hljs-variable constant_\">ACTION</span>.<span class=\"hljs-property\">DELETE</span>:\n      <span class=\"hljs-keyword\">return</span> state.<span class=\"hljs-title function_\">filter</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">todo</span> =&gt;</span> todo.<span class=\"hljs-property\">id</span> !== action.<span class=\"hljs-property\">payload</span>.<span class=\"hljs-property\">id</span>);\n    <span class=\"hljs-attr\">default</span>:\n      <span class=\"hljs-keyword\">return</span> state;\n  }\n};\n\n\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Todos</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-comment\">// Step 1. ä½¿ç”¨ useReducerï¼Œä¸¦å‚³å…¥åˆå§‹å€¼</span>\n  <span class=\"hljs-keyword\">const</span> [todos, dispatch] = <span class=\"hljs-title function_\">useReducer</span>(reducer, []);\n  <span class=\"hljs-keyword\">const</span> [name, setName] = <span class=\"hljs-title function_\">useState</span>(<span class=\"hljs-string\">&quot;&quot;</span>);\n\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">handleSubmit</span> = e =&gt; {\n    e.<span class=\"hljs-title function_\">preventDefault</span>();\n    <span class=\"hljs-comment\">// Step 3. dispatch action</span>\n    <span class=\"hljs-title function_\">dispatch</span>({ <span class=\"hljs-attr\">type</span>: <span class=\"hljs-variable constant_\">ACTION</span>.<span class=\"hljs-property\">ADD_TODO</span>, <span class=\"hljs-attr\">payload</span>: { name } });\n    <span class=\"hljs-title function_\">setName</span>(<span class=\"hljs-string\">&quot;&quot;</span>);\n  };\n\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">handleToggle</span> = id =&gt; {\n    <span class=\"hljs-title function_\">dispatch</span>({ <span class=\"hljs-attr\">type</span>: <span class=\"hljs-variable constant_\">ACTION</span>.<span class=\"hljs-property\">TOGGLE_TODO</span>, <span class=\"hljs-attr\">payload</span>: { id } });\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(todos);\n  };\n\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">handleDelete</span> = id =&gt; {\n    <span class=\"hljs-title function_\">dispatch</span>({ <span class=\"hljs-attr\">type</span>: <span class=\"hljs-variable constant_\">ACTION</span>.<span class=\"hljs-property\">DELETE</span>, <span class=\"hljs-attr\">payload</span>: { id } });\n  };\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">form</span> <span class=\"hljs-attr\">onSubmit</span>=<span class=\"hljs-string\">{handleSubmit}</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">{name}</span> <span class=\"hljs-attr\">onChange</span>=<span class=\"hljs-string\">{e</span> =&gt;</span> setName(e.target.value)} /&gt;\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">form</span>&gt;</span>\n\n      {todos.map(todo =&gt; (\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Todo</span> <span class=\"hljs-attr\">key</span>=<span class=\"hljs-string\">{todo.id}</span> <span class=\"hljs-attr\">todo</span>=<span class=\"hljs-string\">{todo}</span> <span class=\"hljs-attr\">handleToggle</span>=<span class=\"hljs-string\">{handleToggle}</span> <span class=\"hljs-attr\">handleDelete</span>=<span class=\"hljs-string\">{handleDelete}</span> /&gt;</span>\n      ))}\n    <span class=\"hljs-tag\">&lt;/&gt;</span></span>\n  );\n};\n\n</code></pre>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// Todo.jsx</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">Todo</span> = (<span class=\"hljs-params\">{ todo, handleToggle, handleDelete }</span>) =&gt; {\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{{</span> <span class=\"hljs-attr\">color:</span> <span class=\"hljs-attr\">todo.complete</span> ? &quot;<span class=\"hljs-attr\">green</span>&quot; <span class=\"hljs-attr\">:</span> &quot;<span class=\"hljs-attr\">red</span>&quot; }}&gt;</span>{todo.name}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{()</span> =&gt;</span> handleToggle(todo.id)}&gt;Toggle<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">{()</span> =&gt;</span> handleDelete(todo.id)}&gt;Delete<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span>\n  );\n};\n</code></pre>\n<h2 id=\"åƒè€ƒè³‡æ–™\" title=\"åƒè€ƒè³‡æ–™\"><a href=\"#åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</a></h2>\n<ol>\n<li><a  href=\"https://reactjs.org/docs/getting-started.html\" target=\"_blank\" rel=\"noreferrer noopener\">React å®˜æ–¹æ–‡ä»¶</a></li>\n<li><a  href=\"https://www.youtube.com/playlist?list=PLZlA0Gpn_vH8EtggFGERCwMY5u5hOjf-h\" target=\"_blank\" rel=\"noreferrer noopener\">Web Dev Simplified - React Hooks</a></li>\n</ol>\n","toc":{"title":"[Note] React Hooks æ•´ç†","subtitles":["Why Hook?","Hook é€šç”¨è¦å‰‡","useState","useEffect","useLayoutEffect","useMemo","useCallback","useRef","useContext","useReducer","åƒè€ƒè³‡æ–™"]}}