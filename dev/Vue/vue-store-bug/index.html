<!doctype html>
<html data-n-head-ssr lang="zh-tw" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22zh-tw%22%7D%7D">
  <head>
    <title>[Debug] Vue 生命週期的坑｜傑尼海馬迴｜Jennie DEV</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><meta data-n-head="ssr" name="google-site-verification" content="KAONipFn6ticaFtY32RIDOQP-5J9AcuoHlXoV8mzBRc"><meta data-n-head="ssr" data-hid="og:site_name" property="og:site_name" content="傑尼海馬迴｜Jennie DEV"><meta data-n-head="ssr" data-hid="og:type" property="og:type" content="article"><meta data-n-head="ssr" data-hid="og:image" property="og:image" content="/favicon.ico"><meta data-n-head="ssr" data-hid="og:image:width" property="og:image:width" content="300"><meta data-n-head="ssr" data-hid="og:image:height" property="og:image:height" content="300"><meta data-n-head="ssr" data-hid="description" name="description" content="Vue 在註冊 Store 時，因為 lifecycle 踩到的坑！"><meta data-n-head="ssr" data-hid="og:title" name="og:title" content="[Debug] Vue 生命週期的坑｜傑尼海馬迴｜Jennie DEV"><meta data-n-head="ssr" data-hid="og:description" name="og:description" content="Vue 在註冊 Store 時，因為 lifecycle 踩到的坑！"><meta data-n-head="ssr" data-hid="og:url" name="og:url" content="https://jenniesh.github.io/dev/Vue/vue-store-bug"><meta data-n-head="ssr" data-hid="keywords" name="keywords" content="Vue、store、lifecycle"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;700&family=Lato:wght@400;700&display=swap"><link rel="preload" href="/_nuxt/107c79d.js" as="script"><link rel="preload" href="/_nuxt/3603d92.js" as="script"><link rel="preload" href="/_nuxt/b9257ba.js" as="script"><link rel="preload" href="/_nuxt/f9303d9.js" as="script"><link rel="preload" href="/_nuxt/8b51193.js" as="script"><link rel="preload" href="/_nuxt/8e59a34.js" as="script"><style data-vue-ssr-id="54b08540:0 4ec1dd84:0 4ba1b844:0 a57b151a:0 7ca831e9:0 62838aa2:0 781512b7:0 2e855d11:0 0066bdae:0 357a6f66:0 153645fe:0">/*! tailwindcss v2.2.19 | MIT License | https://tailwindcss.com*//*! modern-normalize v1.1.0 | MIT License | https://github.com/sindresorhus/modern-normalize */*,::after,::before{box-sizing:border-box}html{-moz-tab-size:4;-o-tab-size:4;tab-size:4}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji'}hr{height:0;color:inherit}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}:-moz-ui-invalid{box-shadow:none}legend{padding:0}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}fieldset{margin:0;padding:0}ol,ul{list-style:none;margin:0;padding:0}html{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}body{font-family:inherit;line-height:inherit}*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:currentColor}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input:-ms-input-placeholder,textarea:-ms-input-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:-moz-focusring{outline:auto}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,::after,::before{--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-transform:translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-border-opacity:1;border-color:rgba(229,231,235,var(--tw-border-opacity));--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000}.container{width:100%;margin-right:auto;margin-left:auto}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.left-0{left:0}.top-0{top:0}.top-\[14px\]{top:14px}.top-\[-12px\]{top:-12px}.top-\[12px\]{top:12px}.top-\[15\%\]{top:15%}.right-\[-28px\]{right:-28px}.-left-4{left:-1rem}.left-\[-8px\]{left:-8px}.z-10{z-index:10}.m-1{margin:.25rem}.mx-auto{margin-left:auto;margin-right:auto}.mx-8{margin-left:2rem;margin-right:2rem}.my-4{margin-top:1rem;margin-bottom:1rem}.my-7{margin-top:1.75rem;margin-bottom:1.75rem}.mx-1{margin-left:.25rem;margin-right:.25rem}.my-2{margin-top:.5rem;margin-bottom:.5rem}.mx-\[10\%\]{margin-left:10%;margin-right:10%}.my-5{margin-top:1.25rem;margin-bottom:1.25rem}.my-10{margin-top:2.5rem;margin-bottom:2.5rem}.mr-2{margin-right:.5rem}.mt-4{margin-top:1rem}.mr-1{margin-right:.25rem}.mt-8{margin-top:2rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.mb-2{margin-bottom:.5rem}.mb-10{margin-bottom:2.5rem}.mt-6{margin-top:1.5rem}.mt-5{margin-top:1.25rem}.mb-8{margin-bottom:2rem}.ml-4{margin-left:1rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.hidden{display:none}.h-4{height:1rem}.h-full{height:100%}.h-1{height:.25rem}.h-8{height:2rem}.h-6{height:1.5rem}.h-\[70\%\]{height:70%}.h-5{height:1.25rem}.h-\[fit-content\]{height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.h-7{height:1.75rem}.h-60{height:15rem}.h-3{height:.75rem}.max-h-screen{max-height:100vh}.min-h-screen{min-height:100vh}.w-4{width:1rem}.w-1\/5{width:20%}.w-full{width:100%}.w-16{width:4rem}.w-4\/5{width:80%}.w-8{width:2rem}.w-6{width:1.5rem}.w-\[70\%\]{width:70%}.w-5{width:1.25rem}.w-56{width:14rem}.w-7{width:1.75rem}.w-60{width:15rem}.w-\[fit-content\]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.w-3{width:.75rem}.flex-initial{flex:0 1 auto}.flex-none{flex:none}.flex-grow{flex-grow:1}.-rotate-45{--tw-rotate:-45deg;transform:var(--tw-transform)}.rotate-45{--tw-rotate:45deg;transform:var(--tw-transform)}.transform{transform:var(--tw-transform)}.cursor-pointer{cursor:pointer}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-evenly{justify-content:space-evenly}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-r-full{border-top-right-radius:9999px;border-bottom-right-radius:9999px}.border-b-2{border-bottom-width:2px}.border-l-4{border-left-width:4px}.border-b{border-bottom-width:1px}.border-transparent{border-color:transparent}.border-gray-200{--tw-border-opacity:1;border-color:rgba(229,231,235,var(--tw-border-opacity))}.border-light-primary{--tw-border-opacity:1;border-color:rgba(33,90,109,var(--tw-border-opacity))}.bg-light-block{--tw-bg-opacity:1;background-color:rgba(250,250,250,var(--tw-bg-opacity))}.bg-light-bg{--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgba(249,250,251,var(--tw-bg-opacity))}.bg-light-title{--tw-bg-opacity:1;background-color:rgba(33,90,109,var(--tw-bg-opacity))}.bg-light-primary{--tw-bg-opacity:1;background-color:rgba(33,90,109,var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgba(243,244,246,var(--tw-bg-opacity))}.bg-light-gray{--tw-bg-opacity:1;background-color:rgba(113,113,122,var(--tw-bg-opacity))}.p-4{padding:1rem}.p-8{padding:2rem}.px-8{padding-left:2rem;padding-right:2rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-2{padding-left:.5rem;padding-right:.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-5{padding-top:1.25rem;padding-bottom:1.25rem}.px-10{padding-left:2.5rem;padding-right:2.5rem}.pl-1{padding-left:.25rem}.pl-2{padding-left:.5rem}.pl-3{padding-left:.75rem}.pt-1{padding-top:.25rem}.pl-0{padding-left:0}.pl-6{padding-left:1.5rem}.text-center{text-align:center}.text-sm{font-size:.875rem;line-height:1.25rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-2xl{font-size:1.5rem;line-height:2rem}.text-xs{font-size:.75rem;line-height:1rem}.text-\[13px\]{font-size:13px}.text-\[3rem\]{font-size:3rem}.font-bold{font-weight:700}.font-normal{font-weight:400}.uppercase{text-transform:uppercase}.capitalize{text-transform:capitalize}.italic{font-style:italic}.tracking-wide{letter-spacing:.025em}.text-dark-gray{--tw-text-opacity:1;color:rgba(169,169,169,var(--tw-text-opacity))}.text-gray-600{--tw-text-opacity:1;color:rgba(75,85,99,var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgba(156,163,175,var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgba(31,41,55,var(--tw-text-opacity))}.text-light-title{--tw-text-opacity:1;color:rgba(33,90,109,var(--tw-text-opacity))}.text-light-primary{--tw-text-opacity:1;color:rgba(33,90,109,var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgba(107,114,128,var(--tw-text-opacity))}.text-common-gray{--tw-text-opacity:1;color:rgba(113,113,122,var(--tw-text-opacity))}.shadow{--tw-shadow:0 1px 3px 0 rgba(0, 0, 0, 0.1),0 1px 2px 0 rgba(0, 0, 0, 0.06);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.transition{transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms}.delay-500{transition-delay:.5s}.duration-1000{transition-duration:1s}.duration-100{transition-duration:.1s}.hover\:border-common-active:hover{--tw-border-opacity:1;border-color:rgba(146,199,163,var(--tw-border-opacity))}.hover\:bg-light-block:hover{--tw-bg-opacity:1;background-color:rgba(250,250,250,var(--tw-bg-opacity))}.hover\:text-common-active:hover{--tw-text-opacity:1;color:rgba(146,199,163,var(--tw-text-opacity))}.hover\:text-gray-600:hover{--tw-text-opacity:1;color:rgba(75,85,99,var(--tw-text-opacity))}.hover\:shadow-lg:hover{--tw-shadow:0 10px 15px -3px rgba(0, 0, 0, 0.1),0 4px 6px -2px rgba(0, 0, 0, 0.05);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.dark .dark\:bg-dark-black{--tw-bg-opacity:1;background-color:rgba(39,39,42,var(--tw-bg-opacity))}.dark .dark\:bg-dark-block{--tw-bg-opacity:1;background-color:rgba(30,31,37,var(--tw-bg-opacity))}.dark .dark\:text-white{--tw-text-opacity:1;color:rgba(255,255,255,var(--tw-text-opacity))}.dark .dark\:text-dark-gray{--tw-text-opacity:1;color:rgba(169,169,169,var(--tw-text-opacity))}.dark .dark\:text-gray-50{--tw-text-opacity:1;color:rgba(249,250,251,var(--tw-text-opacity))}.dark .dark\:text-dark-text{--tw-text-opacity:1;color:rgba(240,240,240,var(--tw-text-opacity))}@media (min-width:768px){.md\:mt-10{margin-top:2.5rem}.md\:hidden{display:none}.md\:px-16{padding-left:4rem;padding-right:4rem}}@media (min-width:1024px){.lg\:block{display:block}}@media (min-width:1280px){.xl\:block{display:block}.xl\:px-16{padding-left:4rem;padding-right:4rem}.xl\:px-48{padding-left:12rem;padding-right:12rem}}/*! tailwindcss v2.2.19 | MIT License | https://tailwindcss.com*//*! modern-normalize v1.1.0 | MIT License | https://github.com/sindresorhus/modern-normalize */*,::after,::before{box-sizing:border-box}html{-moz-tab-size:4;-o-tab-size:4;tab-size:4}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji'}hr{height:0;color:inherit}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}:-moz-ui-invalid{box-shadow:none}legend{padding:0}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}fieldset{margin:0;padding:0}ol,ul{list-style:none;margin:0;padding:0}html{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}body{font-family:inherit;line-height:inherit}*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:currentColor}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input:-ms-input-placeholder,textarea:-ms-input-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:-moz-focusring{outline:auto}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,::after,::before{--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-transform:translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-border-opacity:1;border-color:rgba(229,231,235,var(--tw-border-opacity));--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000}.container{width:100%;margin-right:auto;margin-left:auto}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.left-0{left:0}.top-0{top:0}.top-\[14px\]{top:14px}.top-\[-12px\]{top:-12px}.top-\[12px\]{top:12px}.top-\[15\%\]{top:15%}.right-\[-28px\]{right:-28px}.-left-4{left:-1rem}.left-\[-8px\]{left:-8px}.z-10{z-index:10}.m-1{margin:.25rem}.mx-auto{margin-left:auto;margin-right:auto}.mx-8{margin-left:2rem;margin-right:2rem}.my-4{margin-top:1rem;margin-bottom:1rem}.my-7{margin-top:1.75rem;margin-bottom:1.75rem}.mx-1{margin-left:.25rem;margin-right:.25rem}.my-2{margin-top:.5rem;margin-bottom:.5rem}.mx-\[10\%\]{margin-left:10%;margin-right:10%}.my-5{margin-top:1.25rem;margin-bottom:1.25rem}.my-10{margin-top:2.5rem;margin-bottom:2.5rem}.mr-2{margin-right:.5rem}.mt-4{margin-top:1rem}.mr-1{margin-right:.25rem}.mt-8{margin-top:2rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.mb-2{margin-bottom:.5rem}.mb-10{margin-bottom:2.5rem}.mt-6{margin-top:1.5rem}.mt-5{margin-top:1.25rem}.mb-8{margin-bottom:2rem}.ml-4{margin-left:1rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.hidden{display:none}.h-4{height:1rem}.h-full{height:100%}.h-1{height:.25rem}.h-8{height:2rem}.h-6{height:1.5rem}.h-\[70\%\]{height:70%}.h-5{height:1.25rem}.h-\[fit-content\]{height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.h-7{height:1.75rem}.h-60{height:15rem}.h-3{height:.75rem}.max-h-screen{max-height:100vh}.min-h-screen{min-height:100vh}.w-4{width:1rem}.w-1\/5{width:20%}.w-full{width:100%}.w-16{width:4rem}.w-4\/5{width:80%}.w-8{width:2rem}.w-6{width:1.5rem}.w-\[70\%\]{width:70%}.w-5{width:1.25rem}.w-56{width:14rem}.w-7{width:1.75rem}.w-60{width:15rem}.w-\[fit-content\]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.w-3{width:.75rem}.flex-initial{flex:0 1 auto}.flex-none{flex:none}.flex-grow{flex-grow:1}.-rotate-45{--tw-rotate:-45deg;transform:var(--tw-transform)}.rotate-45{--tw-rotate:45deg;transform:var(--tw-transform)}.transform{transform:var(--tw-transform)}.cursor-pointer{cursor:pointer}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-evenly{justify-content:space-evenly}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-r-full{border-top-right-radius:9999px;border-bottom-right-radius:9999px}.border-b-2{border-bottom-width:2px}.border-l-4{border-left-width:4px}.border-b{border-bottom-width:1px}.border-transparent{border-color:transparent}.border-gray-200{--tw-border-opacity:1;border-color:rgba(229,231,235,var(--tw-border-opacity))}.border-light-primary{--tw-border-opacity:1;border-color:rgba(33,90,109,var(--tw-border-opacity))}.bg-light-block{--tw-bg-opacity:1;background-color:rgba(250,250,250,var(--tw-bg-opacity))}.bg-light-bg{--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgba(249,250,251,var(--tw-bg-opacity))}.bg-light-title{--tw-bg-opacity:1;background-color:rgba(33,90,109,var(--tw-bg-opacity))}.bg-light-primary{--tw-bg-opacity:1;background-color:rgba(33,90,109,var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgba(243,244,246,var(--tw-bg-opacity))}.bg-light-gray{--tw-bg-opacity:1;background-color:rgba(113,113,122,var(--tw-bg-opacity))}.p-4{padding:1rem}.p-8{padding:2rem}.px-8{padding-left:2rem;padding-right:2rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-2{padding-left:.5rem;padding-right:.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-5{padding-top:1.25rem;padding-bottom:1.25rem}.px-10{padding-left:2.5rem;padding-right:2.5rem}.pl-1{padding-left:.25rem}.pl-2{padding-left:.5rem}.pl-3{padding-left:.75rem}.pt-1{padding-top:.25rem}.pl-0{padding-left:0}.pl-6{padding-left:1.5rem}.text-center{text-align:center}.text-sm{font-size:.875rem;line-height:1.25rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-2xl{font-size:1.5rem;line-height:2rem}.text-xs{font-size:.75rem;line-height:1rem}.text-\[13px\]{font-size:13px}.text-\[3rem\]{font-size:3rem}.font-bold{font-weight:700}.font-normal{font-weight:400}.uppercase{text-transform:uppercase}.capitalize{text-transform:capitalize}.italic{font-style:italic}.tracking-wide{letter-spacing:.025em}.text-dark-gray{--tw-text-opacity:1;color:rgba(169,169,169,var(--tw-text-opacity))}.text-gray-600{--tw-text-opacity:1;color:rgba(75,85,99,var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgba(156,163,175,var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgba(31,41,55,var(--tw-text-opacity))}.text-light-title{--tw-text-opacity:1;color:rgba(33,90,109,var(--tw-text-opacity))}.text-light-primary{--tw-text-opacity:1;color:rgba(33,90,109,var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgba(107,114,128,var(--tw-text-opacity))}.text-common-gray{--tw-text-opacity:1;color:rgba(113,113,122,var(--tw-text-opacity))}.shadow{--tw-shadow:0 1px 3px 0 rgba(0, 0, 0, 0.1),0 1px 2px 0 rgba(0, 0, 0, 0.06);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.transition{transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms}.delay-500{transition-delay:.5s}.duration-1000{transition-duration:1s}.duration-100{transition-duration:.1s}.page-enter-active,.page-leave-active{transition:opacity .5s}.page-enter,.page-leave-to{opacity:0}.fade-enter-active,.fade-leave-active{transition:opacity 1s}.fade-enter,.fade-leave-to{opacity:0}.slide-enter-active,.slide-leave-active{transform:translateX(0);transition:all .5s ease-in-out}.slide-enter,.slide-leave-to{transform:translateX(-100%)}.slide-reverse-enter-active,.slide-reverse-leave-active{transform:translateX(0);transition:all 1.5s ease-in-out}.slide-reverse-enter,.slide-reverse-leave-to{transform:translateX(100%)}@-webkit-keyframes twinkle{0%{box-shadow:inset -3px 0 0 #ffd311}to{box-shadow:inset -3px 0 0 transparent}}@keyframes twinkle{0%{box-shadow:inset -3px 0 0 #ffd311}to{box-shadow:inset -3px 0 0 transparent}}@-webkit-keyframes swing{0%{transform:translateX(0)}50%{transform:translateX(-5px)}to{transform:translateX(0)}}@keyframes swing{0%{transform:translateX(0)}50%{transform:translateX(-5px)}to{transform:translateX(0)}}@-webkit-keyframes fadeInOut{0%{opacity:1}50%{opacity:.3}to{opacity:1}}@keyframes fadeInOut{0%{opacity:1}50%{opacity:.3}to{opacity:1}}*{scroll-behavior:smooth}.app{display:flex;min-height:100vh;flex-direction:column;justify-content:space-between;--tw-text-opacity:1;color:rgba(39,39,42,var(--tw-text-opacity))}.dark .app{--tw-bg-opacity:1;background-color:rgba(45,45,45,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(240,240,240,var(--tw-text-opacity))}.app{font-family:"DM Sans",sans-serif;transition:background-color .5s ease-in-out}.app ::-moz-selection{--tw-bg-opacity:1;background-color:rgba(146,199,163,var(--tw-bg-opacity));--tw-bg-opacity:0.5}.app ::selection{--tw-bg-opacity:1;background-color:rgba(146,199,163,var(--tw-bg-opacity));--tw-bg-opacity:0.5}.dark .app ::-moz-selection{--tw-bg-opacity:0.7}.dark .app ::selection{--tw-bg-opacity:0.7}.container{flex-grow:1}@media (min-width:1280px){.container{max-width:64rem}}@media (min-width:1536px){.container{max-width:80rem}}h1,h2,h3,h4,h5,h6{font-weight:700}h1{font-size:1.5rem;line-height:2rem}h2{font-size:1.25rem;line-height:1.75rem}h3{padding-top:.25rem;padding-bottom:.25rem}.hover\:border-common-active:hover{--tw-border-opacity:1;border-color:rgba(146,199,163,var(--tw-border-opacity))}.hover\:bg-light-block:hover{--tw-bg-opacity:1;background-color:rgba(250,250,250,var(--tw-bg-opacity))}.hover\:text-common-active:hover{--tw-text-opacity:1;color:rgba(146,199,163,var(--tw-text-opacity))}.hover\:text-gray-600:hover{--tw-text-opacity:1;color:rgba(75,85,99,var(--tw-text-opacity))}.hover\:shadow-lg:hover{--tw-shadow:0 10px 15px -3px rgba(0, 0, 0, 0.1),0 4px 6px -2px rgba(0, 0, 0, 0.05);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.dark .dark\:bg-dark-black{--tw-bg-opacity:1;background-color:rgba(39,39,42,var(--tw-bg-opacity))}.dark .dark\:bg-dark-block{--tw-bg-opacity:1;background-color:rgba(30,31,37,var(--tw-bg-opacity))}.dark .dark\:text-white{--tw-text-opacity:1;color:rgba(255,255,255,var(--tw-text-opacity))}.dark .dark\:text-dark-gray{--tw-text-opacity:1;color:rgba(169,169,169,var(--tw-text-opacity))}.dark .dark\:text-gray-50{--tw-text-opacity:1;color:rgba(249,250,251,var(--tw-text-opacity))}.dark .dark\:text-dark-text{--tw-text-opacity:1;color:rgba(240,240,240,var(--tw-text-opacity))}@media (min-width:768px){.md\:mt-10{margin-top:2.5rem}.md\:hidden{display:none}.md\:px-16{padding-left:4rem;padding-right:4rem}}@media (min-width:1024px){.lg\:block{display:block}}@media (min-width:1280px){.xl\:block{display:block}.xl\:px-16{padding-left:4rem;padding-right:4rem}.xl\:px-48{padding-left:12rem;padding-right:12rem}}pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}/*!
  Theme: GitHub Dark
  Description: Dark theme as seen on github.com
  Author: github.com
  Maintainer: @Hirse
  Updated: 2021-05-15

  Outdated base version: https://github.com/primer/github-syntax-dark
  Current colors taken from GitHub's CSS
*/.hljs{color:#c9d1d9;background:#0d1117}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#ff7b72}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#d2a8ff}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-variable{color:#79c0ff}.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#a5d6ff}.hljs-built_in,.hljs-symbol{color:#ffa657}.hljs-code,.hljs-comment,.hljs-formula{color:#8b949e}.hljs-name,.hljs-quote,.hljs-selector-pseudo,.hljs-selector-tag{color:#7ee787}.hljs-subst{color:#c9d1d9}.hljs-section{color:#1f6feb;font-weight:700}.hljs-bullet{color:#f2cc60}.hljs-emphasis{color:#c9d1d9;font-style:italic}.hljs-strong{color:#c9d1d9;font-weight:700}.hljs-addition{color:#aff5b4;background-color:#033a16}.hljs-deletion{color:#ffdcd7;background-color:#67060c}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}header[data-v-98ec6cc0]{display:flex;align-items:center;justify-content:space-between;padding:1rem}@media (min-width:768px){header[data-v-98ec6cc0]{padding-left:4rem;padding-right:4rem}}@media (min-width:1280px){header[data-v-98ec6cc0]{padding-left:12rem;padding-right:12rem}}@media (min-width:1536px){header[data-v-98ec6cc0]{padding-left:20rem;padding-right:20rem}}.logo[data-v-98ec6cc0]{font-size:1.5rem;line-height:2rem;font-weight:700;--tw-text-opacity:1;color:rgba(33,90,109,var(--tw-text-opacity))}.dark .logo[data-v-98ec6cc0]{--tw-text-opacity:1;color:rgba(252,252,252,var(--tw-text-opacity))}.logo-mb[data-v-98ec6cc0]{display:flex;align-items:center;justify-content:center}.nav-pc[data-v-98ec6cc0]{display:none}@media (min-width:768px){.nav-pc[data-v-98ec6cc0]{display:flex}}.nav-pc li[data-v-98ec6cc0]{margin-left:.25rem;margin-right:.25rem;width:4rem;border-bottom-width:2px;border-color:transparent;text-align:center}.nav-pc li[data-v-98ec6cc0]:hover{--tw-text-opacity:1;color:rgba(146,199,163,var(--tw-text-opacity))}.dark .nav-pc li[data-v-98ec6cc0]{--tw-text-opacity:1;color:rgba(169,169,169,var(--tw-text-opacity))}.dark .nav-pc li[data-v-98ec6cc0]:hover{--tw-text-opacity:1;color:rgba(146,199,163,var(--tw-text-opacity))}.nav-pc a[data-v-98ec6cc0]{display:inline-block;height:100%;width:100%}.nav-pc .active[data-v-98ec6cc0]{--tw-border-opacity:1;border-color:rgba(229,231,235,var(--tw-border-opacity));font-weight:700;--tw-text-opacity:1;color:rgba(33,90,109,var(--tw-text-opacity))}.dark .nav-pc .active[data-v-98ec6cc0]{--tw-text-opacity:1;color:rgba(255,212,120,var(--tw-text-opacity))}.nav-mb[data-v-98ec6cc0]{position:absolute;left:0;top:0;z-index:10;height:100%;width:80%;--tw-bg-opacity:1;background-color:rgba(249,250,251,var(--tw-bg-opacity));padding:2rem}.dark .nav-mb[data-v-98ec6cc0]{--tw-bg-opacity:1;background-color:rgba(0,0,0,var(--tw-bg-opacity))}@media (min-width:768px){.nav-mb[data-v-98ec6cc0]{display:none}}.nav-mb li[data-v-98ec6cc0]{margin-bottom:.5rem;cursor:pointer;border-left-width:4px;border-color:transparent;padding-left:.5rem}.nav-mb li[data-v-98ec6cc0]:hover{--tw-text-opacity:1;color:rgba(146,199,163,var(--tw-text-opacity))}.dark .nav-mb li[data-v-98ec6cc0]:hover{--tw-text-opacity:1;color:rgba(146,199,163,var(--tw-text-opacity))}.nav-mb .active[data-v-98ec6cc0]{--tw-border-opacity:1;border-color:rgba(33,90,109,var(--tw-border-opacity))}.dark .nav-mb .active[data-v-98ec6cc0]{--tw-border-opacity:1;border-color:rgba(255,212,120,var(--tw-border-opacity))}.burger-line[data-v-98ec6cc0],.burger-line[data-v-98ec6cc0]:after,.burger-line[data-v-98ec6cc0]:before{position:absolute;height:.25rem;width:2rem;border-radius:.25rem;transition-duration:.5s}.burger-icon[data-v-98ec6cc0]{position:relative;height:2rem;width:2rem;cursor:pointer;transition-duration:1s}@media (min-width:768px){.burger-icon[data-v-98ec6cc0]{display:none}}.burger-line[data-v-98ec6cc0]{top:14px;--tw-bg-opacity:1;background-color:rgba(33,90,109,var(--tw-bg-opacity));transition-delay:.5s}.dark .burger-line[data-v-98ec6cc0]{--tw-bg-opacity:1;background-color:rgba(252,252,252,var(--tw-bg-opacity))}.burger-line[data-v-98ec6cc0]:before{top:-12px;--tw-bg-opacity:1;background-color:rgba(33,90,109,var(--tw-bg-opacity))}.dark .burger-line[data-v-98ec6cc0]:before{--tw-bg-opacity:1;background-color:rgba(252,252,252,var(--tw-bg-opacity))}.burger-line[data-v-98ec6cc0]:after,.burger-line[data-v-98ec6cc0]:before{content:"";transition:transform .5s,top .5s .5s}.burger-line[data-v-98ec6cc0]:after{top:12px;--tw-bg-opacity:1;background-color:rgba(33,90,109,var(--tw-bg-opacity))}.dark .burger-line[data-v-98ec6cc0]:after{--tw-bg-opacity:1;background-color:rgba(252,252,252,var(--tw-bg-opacity))}.burger-line.open[data-v-98ec6cc0]{background-color:transparent;transition-delay:.5s;transition-duration:.1s}.burger-line.open[data-v-98ec6cc0]:before{top:0;--tw-rotate:-45deg;transform:var(--tw-transform);--tw-bg-opacity:1;background-color:rgba(33,90,109,var(--tw-bg-opacity))}.dark .burger-line.open[data-v-98ec6cc0]:before{--tw-bg-opacity:1;background-color:rgba(255,212,120,var(--tw-bg-opacity))}.burger-line.open[data-v-98ec6cc0]:before{transition:top .5s,transform .5s .5s}.burger-line.open[data-v-98ec6cc0]:after{top:0;--tw-rotate:45deg;transform:var(--tw-transform);--tw-bg-opacity:1;background-color:rgba(33,90,109,var(--tw-bg-opacity))}.dark .burger-line.open[data-v-98ec6cc0]:after{--tw-bg-opacity:1;background-color:rgba(255,212,120,var(--tw-bg-opacity))}.burger-line.open[data-v-98ec6cc0]:after{transition:top .5s,transform .5s .5s}.mode-switch[data-v-18cfa5ea]{display:flex;height:1.5rem;width:1.5rem;align-items:center;justify-content:center}.mode-switch .sun[data-v-18cfa5ea]{display:inline-block;height:70%;width:70%;border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(252,211,77,var(--tw-bg-opacity));box-shadow:0 0 6px 1px #ffd501}.mode-switch .moon[data-v-18cfa5ea]{height:100%;width:100%;--tw-text-opacity:1;color:rgba(229,231,235,var(--tw-text-opacity))}section[data-v-68e56674]{position:fixed;left:0;top:15%;display:none;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;width:14rem;--tw-bg-opacity:1;background-color:rgba(250,250,250,var(--tw-bg-opacity));padding-top:1.25rem;padding-bottom:1.25rem;padding-left:2rem;padding-right:2rem}.dark section[data-v-68e56674]{--tw-bg-opacity:1;background-color:rgba(30,31,37,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(240,240,240,var(--tw-text-opacity))}@media (min-width:1280px){section[data-v-68e56674]{display:block}}@media (min-width:1536px){section[data-v-68e56674]{width:16rem}}section[data-v-68e56674]{transform:translateX(-95%);transition:transform 1.2s ease-in-out}section.show[data-v-68e56674]{transform:translateX(0)}section li[data-v-68e56674]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-left:.75rem;padding-top:.25rem;font-size:13px}section a[data-v-68e56674]:hover{--tw-text-opacity:1;color:rgba(146,199,163,var(--tw-text-opacity))}section .title[data-v-68e56674]{margin-bottom:.5rem;padding-left:0;font-size:.875rem;line-height:1.25rem;font-weight:700}section .toc-tab[data-v-68e56674]{position:absolute;top:0;right:-28px;display:flex;height:1.75rem;width:1.75rem;cursor:pointer;align-items:center;justify-content:center;border-top-right-radius:9999px;border-bottom-right-radius:9999px;--tw-bg-opacity:1;background-color:rgba(250,250,250,var(--tw-bg-opacity))}.dark section .toc-tab[data-v-68e56674]{--tw-bg-opacity:1;background-color:rgba(30,31,37,var(--tw-bg-opacity))}.markdown li>code,.markdown p>code{padding:.125rem .25rem;color:#6b7280;background-color:#eee;border-radius:.375rem}.markdown .danger,.markdown .info,.markdown .success,.markdown .warning,.markdown blockquote{margin:1rem 0;padding:.5rem 1rem;border-left:4px solid;border-radius:.25rem}.markdown{max-width:48rem;font-size:.875rem;line-height:1.25rem;line-height:1.625}@media (min-width:1536px){.markdown{max-width:56rem}}.markdown h1{margin-top:1.5rem;margin-bottom:2.5rem;text-align:center;--tw-text-opacity:1;color:rgba(33,90,109,var(--tw-text-opacity))}.dark .markdown h1{--tw-text-opacity:1;color:rgba(252,252,252,var(--tw-text-opacity))}.markdown h2{position:relative;margin-top:4rem;margin-bottom:1rem}.markdown h2:before{position:absolute;left:-16px;--tw-text-opacity:1;color:rgba(146,199,163,var(--tw-text-opacity));content:"»"}.markdown h2 a{--tw-text-opacity:1;color:rgba(44,57,68,var(--tw-text-opacity))}.dark .markdown h2 a{--tw-text-opacity:1;color:rgba(209,213,218,var(--tw-text-opacity))}.markdown h3{margin-top:1.5rem;font-size:16px}.markdown h6{display:none}.markdown a{--tw-text-opacity:1;color:rgba(111,168,129,var(--tw-text-opacity))}.markdown a:hover{border-bottom-width:1px;--tw-border-opacity:1;border-color:rgba(146,199,163,var(--tw-border-opacity))}.markdown img{margin-top:1rem;margin-bottom:1rem}@media (min-width:1536px){.markdown img{width:80%}}.markdown pre{margin-top:1rem;margin-bottom:1rem;white-space:pre-wrap;word-break:break-all;border-radius:.25rem;padding:1rem}@media (min-width:768px){.markdown pre{overflow-wrap:break-word}}.markdown summary{outline:2px solid transparent;outline-offset:2px}.markdown p{margin-top:.75rem;margin-bottom:.75rem;line-height:1.5rem}.markdown li{list-style-position:inside;padding-top:.25rem;padding-bottom:.25rem;padding-left:.5rem}.markdown li p{display:inline}.markdown li>ul>li{list-style-type:circle}.markdown ul>li{list-style-type:disc}.markdown ol>li{list-style-type:decimal}.markdown table{border-width:2px;--tw-border-opacity:1;border-color:rgba(209,213,219,var(--tw-border-opacity))}.markdown table td>:not([hidden])~:not([hidden]),.markdown table tr>:not([hidden])~:not([hidden]){--tw-divide-x-reverse:0;border-right-width:calc(2px * var(--tw-divide-x-reverse));border-left-width:calc(2px * calc(1 - var(--tw-divide-x-reverse)));--tw-divide-opacity:1;border-color:rgba(209,213,219,var(--tw-divide-opacity))}.markdown table td,.markdown table tr{padding-left:.5rem;padding-right:.5rem;padding-top:.25rem;padding-bottom:.25rem}.markdown table tr:nth-child(even){--tw-bg-opacity:1;background-color:rgba(243,244,246,var(--tw-bg-opacity))}.dark .markdown table tr:nth-child(even){--tw-bg-opacity:0.2}.markdown table thead{border-bottom-width:2px;--tw-border-opacity:1;border-color:rgba(209,213,219,var(--tw-border-opacity))}.markdown table tbody>:not([hidden])~:not([hidden]){--tw-divide-y-reverse:0;border-top-width:calc(2px * calc(1 - var(--tw-divide-y-reverse)));border-bottom-width:calc(2px * var(--tw-divide-y-reverse));--tw-divide-opacity:1;border-color:rgba(209,213,219,var(--tw-divide-opacity))}.markdown blockquote{--tw-border-opacity:1;border-color:rgba(102,102,102,var(--tw-border-opacity));--tw-bg-opacity:1;background-color:rgba(238,238,238,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(106,114,128,var(--tw-text-opacity))}.dark .markdown blockquote{--tw-bg-opacity:0.8}.markdown .success{--tw-border-opacity:1;border-color:rgba(127,141,124,var(--tw-border-opacity));--tw-bg-opacity:1;background-color:rgba(202,217,192,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(51,105,30,var(--tw-text-opacity))}.dark .markdown .success{--tw-bg-opacity:0.9}.markdown .info{--tw-border-opacity:1;border-color:rgba(79,114,138,var(--tw-border-opacity));--tw-bg-opacity:1;background-color:rgba(200,218,233,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(83,100,131,var(--tw-text-opacity))}.dark .markdown .info{--tw-bg-opacity:0.9}.markdown .warning{--tw-border-opacity:1;border-color:rgba(211,174,91,var(--tw-border-opacity));--tw-bg-opacity:1;background-color:rgba(248,240,210,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(147,115,47,var(--tw-text-opacity))}.dark .markdown .warning{--tw-bg-opacity:0.9}.markdown .danger{--tw-border-opacity:1;border-color:rgba(213,157,164,var(--tw-border-opacity));--tw-bg-opacity:1;background-color:rgba(241,222,223,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(164,74,67,var(--tw-text-opacity))}.dark .markdown .danger{--tw-bg-opacity:0.9}.markdown .spoiler{border-radius:.25rem;border-width:1px;border-style:dashed;padding:.5rem}.info[data-v-5c0fb0a4]{display:flex;align-items:center;font-size:.875rem;line-height:1.25rem;font-weight:700;--tw-text-opacity:1;color:rgba(75,85,99,var(--tw-text-opacity))}.dark .info[data-v-5c0fb0a4]{--tw-text-opacity:1;color:rgba(249,250,251,var(--tw-text-opacity))}.info-item[data-v-5c0fb0a4]{display:flex;align-items:center}.info-link[data-v-5c0fb0a4]{text-transform:uppercase}.info-link[data-v-5c0fb0a4]:hover{--tw-text-opacity:1;color:rgba(111,168,129,var(--tw-text-opacity))}.info-icon[data-v-5c0fb0a4]{display:inline-block;height:1rem;width:1rem;--tw-text-opacity:1;color:rgba(156,163,175,var(--tw-text-opacity))}.tag[data-v-66ee7d80]{margin:.25rem;border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(243,244,246,var(--tw-bg-opacity));padding-left:.5rem;padding-right:.5rem;padding-top:.25rem;padding-bottom:.25rem;font-size:.75rem;line-height:1rem;letter-spacing:.025em;--tw-text-opacity:1;color:rgba(107,114,128,var(--tw-text-opacity))}.dark .tag[data-v-66ee7d80]{--tw-bg-opacity:1;background-color:rgba(55,65,81,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(249,250,251,var(--tw-text-opacity))}footer[data-v-301919f7]{display:flex;align-items:center;justify-content:center;padding-top:1rem;padding-bottom:1rem}</style><link rel="preload" href="/_nuxt/static/1765984263/dev/Vue/vue-store-bug/state.js" as="script"><link rel="preload" href="/_nuxt/static/1765984263/dev/Vue/vue-store-bug/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1765984263/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="app"><header data-v-98ec6cc0><div class="logo" data-v-98ec6cc0><h1 data-v-98ec6cc0><a href="/" class="nuxt-link-active" data-v-98ec6cc0>Jennie DEV</a></h1></div> <nav data-v-98ec6cc0><ul class="nav-pc" data-v-98ec6cc0><li class="active" data-v-98ec6cc0><a href="/dev" class="nuxt-link-active" data-v-98ec6cc0>Dev</a></li><li data-v-98ec6cc0><a href="/life" data-v-98ec6cc0>Life</a></li><li data-v-98ec6cc0><a href="/" class="nuxt-link-active" data-v-98ec6cc0>About</a></li> <button class="mode-switch ml-1" data-v-18cfa5ea data-v-98ec6cc0><svg xmlns="http://www.w3.org/2000/svg" class="moon icon sprite-icons" style="display:none" data-v-18cfa5ea data-v-18cfa5ea><use href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-moon" xlink:href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-moon" data-v-18cfa5ea data-v-18cfa5ea></use></svg> <span class="sun" data-v-18cfa5ea></span></button></ul> <ul class="nav-mb" style="display:none" data-v-98ec6cc0 data-v-98ec6cc0><li class="logo logo-mb" data-v-98ec6cc0><a href="/" class="nuxt-link-active" data-v-98ec6cc0>Jennie DEV</a> <button class="mode-switch ml-2" data-v-18cfa5ea data-v-98ec6cc0><svg xmlns="http://www.w3.org/2000/svg" class="moon icon sprite-icons" style="display:none" data-v-18cfa5ea data-v-18cfa5ea><use href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-moon" xlink:href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-moon" data-v-18cfa5ea data-v-18cfa5ea></use></svg> <span class="sun" data-v-18cfa5ea></span></button></li> <li class="active" data-v-98ec6cc0><a href="/dev" class="nuxt-link-active" data-v-98ec6cc0>
            Dev
          </a></li><li data-v-98ec6cc0><a href="/life" data-v-98ec6cc0>
            Life
          </a></li><li data-v-98ec6cc0><a href="/" class="nuxt-link-active" data-v-98ec6cc0>
            About
          </a></li></ul> <div class="burger-icon" data-v-98ec6cc0><div class="burger-line" data-v-98ec6cc0></div></div></nav></header> <main class="flex mx-auto container" data-v-0237b367><section class="show" data-v-68e56674 data-v-0237b367><ul data-v-68e56674><li class="title" data-v-68e56674><a href="#[Debug] Vue 生命週期的坑 - 註冊 Store" title="[Debug] Vue 生命週期的坑 - 註冊 Store" data-v-68e56674>[Debug] Vue 生命週期的坑 - 註冊 Store</a></li> <li data-v-68e56674><a href="#註冊 Store 機制遇到 bug" title="註冊 Store 機制遇到 bug" data-v-68e56674>註冊 Store 機制遇到 bug</a></li><li data-v-68e56674><a href="#beforeRouteLeave (有坑，暫不考慮，除非防呆寫得好，可以一試)" title="beforeRouteLeave (有坑，暫不考慮，除非防呆寫得好，可以一試)" data-v-68e56674>beforeRouteLeave (有坑，暫不考慮，除非防呆寫得好，可以一試)</a></li><li data-v-68e56674><a href="#動態命名 store" title="動態命名 store" data-v-68e56674>動態命名 store</a></li><li data-v-68e56674><a href="#動態路由" title="動態路由" data-v-68e56674>動態路由</a></li><li data-v-68e56674><a href="#先反註冊，再註冊" title="先反註冊，再註冊" data-v-68e56674>先反註冊，再註冊</a></li><li data-v-68e56674><a href="#參考資料" title="參考資料" data-v-68e56674>參考資料</a></li></ul> <div class="toc-tab" data-v-68e56674><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 icon sprite-icons" data-v-68e56674 data-v-68e56674><use href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-menu" xlink:href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-menu" data-v-68e56674 data-v-68e56674></use></svg></div></section> <article class="mx-auto px-8 py-6 xl:px-16 dark:bg-dark-black" data-v-5c0fb0a4 data-v-0237b367><div class="info" data-v-5c0fb0a4><a href="/dev/Vue" title="Back to Vue" class="info-item info-link nuxt-link-active" data-v-5c0fb0a4><svg xmlns="http://www.w3.org/2000/svg" class="info-icon mr-2 icon sprite-icons" data-v-5c0fb0a4><use href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-folder-open" xlink:href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-folder-open" data-v-5c0fb0a4></use></svg>
      Vue
    </a> <div class="info-item mx-8" data-v-5c0fb0a4><svg xmlns="http://www.w3.org/2000/svg" class="info-icon mr-2 icon sprite-icons" data-v-5c0fb0a4 data-v-5c0fb0a4><use href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-calendar" xlink:href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-calendar" data-v-5c0fb0a4 data-v-5c0fb0a4></use></svg>
      15 Dec 2024
    </div> <div class="info-item" data-v-5c0fb0a4><svg xmlns="http://www.w3.org/2000/svg" class="info-icon mr-2 icon sprite-icons" data-v-5c0fb0a4 data-v-5c0fb0a4><use href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-clock" xlink:href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-clock" data-v-5c0fb0a4 data-v-5c0fb0a4></use></svg>
      6 min read
    </div></div> <div class="markdown" data-v-5c0fb0a4><h6>tags: <code>Vue</code>、<code>store</code>、<code>lifecycle</code></h6>
<h1 id="[Debug] Vue 生命週期的坑 - 註冊 Store" title="[Debug] Vue 生命週期的坑 - 註冊 Store">[Debug] Vue 生命週期的坑 - 註冊 Store</h1>
<h2 id="註冊 Store 機制遇到 bug" title="註冊 Store 機制遇到 bug"><a href="#註冊 Store 機制遇到 bug">註冊 Store 機制遇到 bug</a></h2>
<h3>已知條件</h3>
<ul>
<li><code>/zh</code>、<code>/en</code> 兩路徑共用同一組件 <code>Index.vue</code></li>
<li><code>Index.vue</code> 在 <code>setup</code> 時註冊 store，在 <code>onBeforeUnmount</code> 移除該註冊 store</li>
</ul>
<pre class="hljs"><code><span class="hljs-comment">// router/index.js</span>
<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/zh'</span>,
    <span class="hljs-attr">component</span>: { <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-params">c</span> =></span> <span class="hljs-title function_">c</span>(<span class="hljs-string">'router-view'</span>) },
    <span class="hljs-comment">// path : /zh</span>
    <span class="hljs-attr">children</span>: [{
      <span class="hljs-attr">path</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">'Index'</span>,
      <span class="hljs-attr">component</span>: <span class="hljs-title class_">Index</span>
    }]
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/en'</span>,
    <span class="hljs-attr">component</span>: { <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-params">c</span> =></span> <span class="hljs-title function_">c</span>(<span class="hljs-string">'router-view'</span>) },
    <span class="hljs-comment">// path : /en</span>
    <span class="hljs-attr">children</span>: [{
      <span class="hljs-attr">path</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">'Index'</span>,
      <span class="hljs-attr">component</span>: <span class="hljs-title class_">Index</span>
    }]
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'*'</span>,
    <span class="hljs-attr">redirect</span>: <span class="hljs-string">'/zh'</span>
  }
]

</code></pre>
<pre class="hljs"><code><span class="hljs-comment">// Index.vue</span>
setup (props, context) {
    <span class="hljs-keyword">const</span> { $store, $registerModule, $unregisterModule } = context.<span class="hljs-property">root</span>

    <span class="hljs-comment">// setup 註冊 store</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setup - registerModule'</span>)
    $registerModule($store, { <span class="hljs-attr">index</span>: <span class="hljs-title class_">StoreModule</span> })

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setup - get count from index store'</span>)
    <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =></span> $store.<span class="hljs-property">state</span>.<span class="hljs-property">index</span>.<span class="hljs-property">count</span>)

    <span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =></span> { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'onMounted'</span>) })

    <span class="hljs-comment">// onBeforeUnmount 移除註冊 store</span>
    <span class="hljs-title function_">onBeforeUnmount</span>(<span class="hljs-function">() =></span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'onBeforeUnmount - unregisterModule'</span>)
      $unregisterModule($store, [<span class="hljs-string">'index'</span>])
    })

    <span class="hljs-keyword">return</span> {
      count
    }
}
</code></pre>
<h3>Runtime Error</h3>
<p>當 <code>/zh</code> 經由 router push 到 <code>/en</code>，<code>/en</code> 由 <code>store</code> 取出的 <code>count</code> 會得到 <code>undefined</code>。</p>
<p><img src="https://i.imgur.com/EaWvryy.png" alt=""></p>
<h3>原因</h3>
<p>由印出來的結果看到， <code>/zh</code> 在 <code>onBeforeUnmount</code> 移除註冊的 store，順序比 <code>/en</code> 的 <code>setup</code> 來得慢，因為兩者個路徑是共用 <code>Index.vue</code> 的 store，當 <code>/zh</code> 觸發移除 <code>Index.vue</code> 的 store，<code>/en</code> 在 Mount 時會拿不到 store 中 count 的值，就報錯了。</p>
<p><img src="https://i.imgur.com/dz4sVYj.png" alt=""></p>
<div class="info">
<p>補充：<br>
Options API 一樣會有錯誤。<br>
<code>Index.vue</code> 在 <code>beforeCreate</code> 時註冊 store，在 <code>beforeDestroy</code> 移除該註冊 store。</p>
<p><img src="https://i.imgur.com/1uzRntT.png" alt=""></p>
</div>
<div class="info">
<p>補充：<br>
在上面圖中，第二次的 <code>setup - wonder to registerModule</code> 並未再重新註冊，因為在程式內有檢查，有註冊的話就不在重新註冊，會共用先前註冊的同名 store，在各時機點加更精確的描述，圖如下。<br>
<img src="https://i.imgur.com/DjUb6dV.png" alt=""></p>
</div>
<div class="info">
<p>補充：<br>
<code>/zh</code> 使用的是 <code>Index.vue</code> 組件，<code>/zh/cat</code> 使用的是 <code>Cat.vue</code>，雖然 <code>/zh/cat</code> setup 晚於 <code>/zh</code> 的<code>onBeforeUnmount</code>，但兩個路徑<strong>不共用同一個 store</strong>，基本上就跟平常用法一樣，不受影響。</p>
<p><img src="https://i.imgur.com/OITqBiQ.png" alt=""></p>
</div>
<h3>小結論</h3>
<ul>
<li>
<p>應該可以排除註冊 <code>registerModule</code> 機制的問題，由結果可知是 <strong>Vue Lifecycle Hooks</strong> 問題比較大。但這錯誤情境目前只遇到發生在建立<strong>明確的不同路徑</strong> (即上面 <code>router/index</code> 那樣的寫法)，使用同一個組件，並<strong>換路徑時試圖移除前一個同名 store 再註冊一個新的同名 store</strong> 時會遇到 。</p>
</li>
<li>
<p>本來看到最後 <code>onMounted</code> 會比上面的 <code>onBeforeUnmount</code> 還晚發生，所以想把 <code>registerModule</code> 改成放在 <code>Mounted</code> 階段，但後來想，這樣在第一次 <code>setup</code> 裡面的變數如果是需從 store 取得，也一樣會報錯，此法不通 ❎。</p>
</li>
</ul>
<h3>解法</h3>
<blockquote>
<p>情境: 不同路徑共用同一個組件註冊的 store，且可直接互相跳轉路徑</p>
</blockquote>
<p><s>* 解法一： <strong><code>beforeRouteLeave</code></strong> - 適用情境為，不同路徑<strong>不想要共享 store 內資料</strong> - 在組件內直接調用 <code>beforeRouteLeave</code>，在此階段 <code>unregisterModule</code>，強制取消註冊的 store</s></p>
<ul>
<li>
<p>解法二：<strong>動態命名 store</strong></p>
<ul>
<li>適用情境為，不同路徑<strong>不想要共享 store 內資料</strong></li>
<li>對每個路徑，客製化命名 store（e.g. <code>zh-index</code>），雖共用同組件，但每個路徑的 store 都為獨立的</li>
<li>缺點為暫時性會有兩個 store 同時存在，要額外多寫一點程式碼。
<blockquote>
<p>還有命名問題，為每個 store 客製化名字同時，也要思考如果別的 component 取該 store 資料時，如何知道目標的 store 名字。</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>解法三：<strong>動態路由</strong></p>
<ul>
<li>適用情境為，不同路徑<strong>想要共享 store 內資料</strong></li>
<li>優點是<strong>擴充性加</strong>，以後有更多路徑需求也不需要手動新增 (e.g. <code>/jp</code>)，也解決原 registerModule 在 Vue 中遇到生命週期的問題。</li>
<li>可透過 <code>context.root.$route.params</code> 拿到網址中的 params<br>
<br>
<blockquote>
<p>原來的<strong>組件實例會被複用</strong>。因為兩個路由都渲染同個組件，比起銷毀再創建，<strong>複用則顯得更加高效</strong>。不過，這也意味著組件的生命週期鉤子不會再被調用。 -<a href="https://router.vuejs.org/zh/guide/essentials/dynamic-matching.html#%E5%93%8D%E5%BA%94%E8%B7%AF%E7%94%B1%E5%8F%82%E6%95%B0%E7%9A%84%E5%8F%98%E5%8C%96" target="_blank" rel="noreferrer noopener">Vue.js 官方 - 響應路由參數的變化</a></p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>解法四：<strong>先反註冊，再註冊</strong></p>
<ul>
<li><strong>適用</strong>以上<strong>兩種情境</strong>，即想共享或不想共享 store 內的資料皆可</li>
<li>註冊 store、移除 store 時，都要接收一個參數(e.g. <code>uuid</code>)來檢查。不同路徑在註冊階段會針對先前已註冊的同名 store 先移除，再註冊。（翻譯：限制組件只能 <code>unregisterModule</code> 自己 <code>registerModule</code> 的 store）</li>
<li>缺點是每次使用時要多傳入可識別的 id 和多一個地方存每個 store 的名字
<blockquote>
<p>原本打算使用 Vue Component 的 uid，但<a href="https://github.com/vuejs/vue/issues/5886" target="_blank" rel="noreferrer noopener">官方不推薦使用</a>，如真要採用，可以用<a href="https://www.npmjs.com/package/uuidv4" target="_blank" rel="noreferrer noopener">套件</a>或自己實作 uuid。</p>
<p>The vm _uid is reserved for internal use and it’s important to keep it private (and not rely on it in user code) so that we keep the flexibility to change its behavior for potential future use cases.</p>
<p>For userland use cases, I’d suggest generating UIDs yourself - you can write a simple module/service that generates uids and import it into your components, or, if you want it for every component, make it a (global) mixin. - Evan You</p>
</blockquote>
</li>
</ul>
<ul>
<li>無法滿足頁面會同時存在兩個會註冊同 store 名的相同組件情境
<blockquote>
<p>e.g. 兩個相同組件 (Index.vue) 同時都會註冊名為 index 的 store，永遠都只保留最後一個組件註冊的。</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h2 id="<s>beforeRouteLeave</s> (有坑，暫不考慮，除非防呆寫得好，可以一試)" title="<s>beforeRouteLeave</s> (有坑，暫不考慮，除非防呆寫得好，可以一試)"><a href="#<s>beforeRouteLeave</s> (有坑，暫不考慮，除非防呆寫得好，可以一試)"><s>beforeRouteLeave</s> (有坑，暫不考慮，除非防呆寫得好，可以一試)</a></h2>
<p>只需在組件內原本在 <code>onBeforeUnmount</code> 做的 <code>unregisterModule</code>，改由在 <code>beforeRouteLeave</code> 時執行。</p>
<pre class="hljs"><code><span class="hljs-comment">// Index.vue</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineComponent</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Index'</span>,
  setup (props, context) {
    <span class="hljs-keyword">const</span> { $store, $registerModule } = context.<span class="hljs-property">root</span>

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setup - wonder to registerModule'</span>)
    $registerModule($store, { <span class="hljs-attr">index</span>: <span class="hljs-title class_">StoreModule</span> })

    ...
  },
  beforeRouteLeave (to, <span class="hljs-keyword">from</span>, next) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'index beforeRouterLeave.'</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'beforeRouteLeave - unregisterModule'</span>)
    <span class="hljs-variable language_">this</span>.$unregisterModule(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>, [<span class="hljs-string">'index'</span>])
    <span class="hljs-title function_">next</span>()
  }
})
</code></pre>
<p><img src="https://i.imgur.com/4IB4evz.png" alt=""></p>
<h3>棄用原因</h3>
<p>雖然看似美好，在 <code>/en</code> setup 前就先 <code>unregisterModule</code>，但實際 runtime 一樣會報錯。</p>
<p><img src="https://i.imgur.com/pxuzG6G.png" alt=""></p>
<p>原因是因為在 <code>beforeRouteLeave</code> 時移除了共有的 index store，但 <code>/zh</code> 的 <code>Index.vue</code> 組件被卸載的時間點晚於 <code>unregisterModule</code> 時間點，由於 count 剛好依賴 store 內的資料且組件尚未移除，此時 store 被拔除，直接報錯。</p>
<h2 id="動態命名 store" title="動態命名 store"><a href="#動態命名 store">動態命名 store</a></h2>
<p>在 <code>registerModule</code>，依據路徑不同，給予不同 store 名，視同各自擁有自己獨立的 store，<code>/zh</code> 移除註銷 store 就不影響 <code>/en</code>。</p>
<pre class="hljs"><code>setup (props, context) {
    <span class="hljs-keyword">const</span> { $store, $router, $registerModule, $unregisterModule } = context.<span class="hljs-property">root</span>
    <span class="hljs-keyword">const</span> currentRouteParams = $router.<span class="hljs-property">currentRoute</span>.<span class="hljs-property">path</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">'/'</span>)[<span class="hljs-number">1</span>]
    <span class="hljs-keyword">const</span> lang = <span class="hljs-string">`<span class="hljs-subst">${currentRouteParams}</span>-index`</span>

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setup - wonder to registerModule'</span>)
    $registerModule($store, { [lang]: <span class="hljs-title class_">StoreModule</span> })

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setup - get count from index store'</span>)
    <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =></span> $store.<span class="hljs-property">state</span>[lang].<span class="hljs-property">count</span>)

    <span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =></span> { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'onMounted'</span>) })

    <span class="hljs-title function_">onBeforeUnmount</span>(<span class="hljs-function">() =></span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'index - onBeforeUnmount'</span>)
      $unregisterModule($store, [lang])
    })
    <span class="hljs-keyword">return</span> {
      count
    }
}
</code></pre>
<p><img src="https://i.imgur.com/Zeh668U.png" alt=""></p>
<p>可用 Vue DevTools 更清楚看到順序和 store 的名字。</p>
<p><img src="https://i.imgur.com/nOaiUYk.png" alt=""></p>
<h2 id="動態路由" title="動態路由"><a href="#動態路由">動態路由</a></h2>
<p>只需要修改 <code>router/index.js</code> 中 <code>routes</code> 設定：</p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/:lang'</span>,
    <span class="hljs-attr">component</span>: { <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-params">c</span> =></span> <span class="hljs-title function_">c</span>(<span class="hljs-string">'router-view'</span>) },
    <span class="hljs-comment">// path - /:lang</span>
    <span class="hljs-attr">children</span>: [{
      <span class="hljs-attr">path</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">'Index'</span>,
      <span class="hljs-attr">component</span>: <span class="hljs-title class_">Index</span>
    }]
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'*'</span>,
    <span class="hljs-attr">redirect</span>: <span class="hljs-string">'/zh'</span>
  }
]
</code></pre>
<pre class="hljs"><code>// 如果還有子路徑可以設置如下：
const routes = [
  {
    path: '/:lang',
    component: { render: c => c('router-view') },
    // path : /:lang
    children: [{
      path: '',
      name: 'Index',
      component: Index
    },
    // path : /:lang/cat
    {
      path: 'cat',
      name: 'Cat',
      component: () =>
        import(/* webpackChunkName: "cat" */ '../containers/Cat/index.vue')
    }]
  },
  {
    path: '*',
    redirect: '/zh'
  }
]
</code></pre>
<p>再看一下當路徑切換時，<code>Index.vue</code> 的活動：</p>
<ul>
<li>路徑在切換（<code>/zh</code> -> <code>/en</code>）時只做 router push 動作</li>
<li>此階段不會移除 store，兩個路徑一樣共用同 store</li>
</ul>
<p><img src="https://i.imgur.com/v3lHuBT.png" alt=""></p>
<ul>
<li>只有進入到不同組件時，<code>Index.vue</code> 才會被 <code>unregisterModule</code>
<blockquote>
<p><code>/en</code> 頁面組件為 <code>&lt;Index></code>，<code>/en/cat</code> 頁面組件為 <code>&lt;Cat></code></p>
</blockquote>
</li>
</ul>
<p><img src="https://i.imgur.com/0U71jt2.png" alt=""></p>
<h2 id="先反註冊，再註冊" title="先反註冊，再註冊"><a href="#先反註冊，再註冊">先反註冊，再註冊</a></h2>
<p>由印出來的步驟可發現，原本方法和反註冊方法，走的流程都是一模一樣的，<strong>在 <code>Index.vue</code> 使用方法也一樣</strong>，在 <code>setup</code> 時註冊 store，在 <code>onBeforeUnmount</code> 移除該 store，但很明顯，原來的方法，會 runtime error，。</p>
<p><img src="https://i.imgur.com/Oc9n512.png" alt=""></p>
<p>用 Vue DevTools 可以更清楚看出差異處，原本 <code>unregisterModule</code> 是由 <code>/zh</code> 執行，改成 <code>/en</code> 在 <code>registerModule</code> 前執行掉了，這樣就不存在 <code>/en</code> 會使用到的 store，因生命週期的不如預期而造成 <code>/zh</code> 在 <code>onBeforeUnmount</code> 將之誤移除情境。</p>
<p><img src="https://i.imgur.com/XGco5ot.png" alt=""></p>
<h3>作法</h3>
<h4>1. <code>store name</code>-<code>component uid</code> Map</h4>
<p>在全域會建立一個 <code>store name</code> 和 <code>component uid</code> 的 <code>currentStoreNameMap</code>。</p>
<h4>2. registerModule</h4>
<p>每次呼叫 <code>registerModule</code> 方法時，會先去取得當前呼叫這方法的 component 中的<code>uid</code>，再檢查該 <code>store name</code> 是否存在在 <code>currentStoreNameMap</code> 中，<strong>如果存在，先卸除該 store</strong>，再建立一個新 store，接著把 <code>store name</code> 和呼叫的 <code>component uid</code> 存回 <code>currentStoreNameMap</code> 。</p>
<h4>3. unregisterModule</h4>
<p>在真正卸載 store 前，會先拿當前呼叫這方法(<code>unregisterModule</code>)的 component 中的<code>uid</code>，與 <code>currentStoreNameMap</code> 對應 <code>store name</code> 的 <code>uid</code> 做比較，如果為同一個 <code>uid</code> 且存在的 store 就執行卸除，即<strong>確保預移除的 store name 跟呼叫 unregisterModule 是必須是相同一個組件</strong>，就不發生 Page A 誤移除到 Page B 中的同名 store。</p>
<h2 id="參考資料" title="參考資料"><a href="#參考資料">參考資料</a></h2>
<ol>
<li><a href="https://iter01.com/467302.html" target="_blank" rel="noreferrer noopener">Vue3.x 生命週期 和 Composition API 核心語法理解</a>
<blockquote>
<p>詳細比較 Vue3 和 Vue2 + Composition API Lifecycle Hooks 順序，如混用需注意順序，結論是不要混用。</p>
</blockquote>
</li>
<li><a href="https://vuex.vuejs.org/" target="_blank" rel="noreferrer noopener">Vuex 官網</a>、<a href="https://router.vuejs.org/zh/api/" target="_blank" rel="noreferrer noopener">Vue Router 官網</a></li>
<li><a href="https://medium.com/@fabien705cccc/vue-%E7%9A%84%E7%94%9F%E5%91%BD%E9%80%B1%E6%9C%9F-lifecycle-3522c481e63f" target="_blank" rel="noreferrer noopener">Vue 的生命週期(Lifecycle)</a></li>
<li><a href="https://ithelp.ithome.com.tw/articles/10214921" target="_blank" rel="noreferrer noopener">Router 與生命週期</a></li>
<li><a href="https://juejin.cn/post/6844903635873185806" target="_blank" rel="noreferrer noopener">Vuex 模块动态注册的一些实践经验</a></li>
<li><a href="https://t.codebug.vip/questions-33383.htm" target="_blank" rel="noreferrer noopener">Vuejs：如何為每个元件例項設置唯一 ID？</a></li>
</ol>
</div> <div class="flex flex-wrap items-center mt-4" data-v-5c0fb0a4><svg xmlns="http://www.w3.org/2000/svg" class="info-icon mr-1 icon sprite-icons" data-v-5c0fb0a4 data-v-5c0fb0a4><use href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-tag" xlink:href="/_nuxt/4cda34de928b58fed6e3d333f053843a.svg#i-tag" data-v-5c0fb0a4 data-v-5c0fb0a4></use></svg> <span class="tag" data-v-66ee7d80 data-v-5c0fb0a4>Vue</span><span class="tag" data-v-66ee7d80 data-v-5c0fb0a4>store</span><span class="tag" data-v-66ee7d80 data-v-5c0fb0a4>lifecycle</span></div> <div class="flex flex-wrap justify-between mt-4 text-sm italic text-dark-gray" data-v-5c0fb0a4><div data-v-5c0fb0a4>Published on 15 Dec 2024</div> <div data-v-5c0fb0a4>Updated on 15 Dec 2024</div></div></article></main> <footer data-v-301919f7>Copyright © 2025 JennieSH</footer></div></div></div><script defer src="/_nuxt/static/1765984263/dev/Vue/vue-store-bug/state.js"></script><script src="/_nuxt/107c79d.js" defer></script><script src="/_nuxt/8b51193.js" defer></script><script src="/_nuxt/8e59a34.js" defer></script><script src="/_nuxt/3603d92.js" defer></script><script src="/_nuxt/b9257ba.js" defer></script><script src="/_nuxt/f9303d9.js" defer></script>
  </body>
</html>
