{"info":{"title":"[Note] Event Handling","fileName":"event-handling","description":"JavaScript 的 Event Handling 介紹","createdAt":"2025-07-19T00:00:00.000Z","updatedAt":"2025-07-19T00:00:00.000Z","tags":["JavaScript","event handling"]},"content":"<h6>tags: <code>JavaScript</code> <code>front-end</code> <code>Event Handling</code></h6>\n<h1 id=\"[Note] Event Handling\" title=\"[Note] Event Handling\">[Note] Event Handling</h1>\n<h3><code>addEventListener()</code>的參數</h3>\n<pre class=\"hljs\"><code><span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-keyword\">type</span>, listener);\n<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-keyword\">type</span>, listener, options);\n<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-keyword\">type</span>, listener, useCapture);\n</code></pre>\n<ul>\n<li><code>Event Type</code>：string，事件的類型，例如： click。</li>\n<li><code>Event Listener</code>：function，事件執行時觸發的函式。</li>\n<li><code>useCapture</code>： boolean，決定事件是以「捕獲」或「冒泡」機制執行，預設為 false （冒泡）。</li>\n</ul>\n<h3>取消事件傳遞 - <code>e.stopPropagation</code></h3>\n<img src=\"https://static.coderbridge.com/img/techbridge/images/huli/event/event_p2.png\">\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// list 的捕獲</span>\n$list.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;list capturing&#x27;</span>, e.<span class=\"hljs-property\">eventPhase</span>);\n  e.<span class=\"hljs-title function_\">stopPropagation</span>();\n}, <span class=\"hljs-literal\">true</span>)\n\n<span class=\"hljs-comment\">// console</span>\nlist capturing\n<span class=\"hljs-number\">1</span>\n\n\n<span class=\"hljs-comment\">// 若是同一個節點上有不只一個 listener，還是會被執行到</span>\n<span class=\"hljs-comment\">// list 的捕獲</span>\n$list.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;list capturing&#x27;</span>);\n  e.<span class=\"hljs-title function_\">stopPropagation</span>();\n}, <span class=\"hljs-literal\">true</span>)\n\n<span class=\"hljs-comment\">// list 的捕獲 2</span>\n$list.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;list capturing2&#x27;</span>);\n}, <span class=\"hljs-literal\">true</span>)\n\n<span class=\"hljs-comment\">//console</span>\nlist capturing\nlist capturing2\n</code></pre>\n<p>若是要讓其他同一層級的 listener 也不要被執行，可以改用<code>e.stopImmediatePropagation()</code></p>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// list 的捕獲</span>\n$list.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;list capturing&#x27;</span>);\n  e.<span class=\"hljs-title function_\">stopImmediatePropagation</span>();\n}, <span class=\"hljs-literal\">true</span>)\n\n<span class=\"hljs-comment\">// list 的捕獲 2</span>\n$list.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;list capturing2&#x27;</span>);\n}, <span class=\"hljs-literal\">true</span>)\n\n<span class=\"hljs-comment\">// console</span>\nlist capturing\n</code></pre>\n<h3>取消預設行為 - <code>e.preventDefault</code></h3>\n<ul>\n<li>取消瀏覽器的預設行為</li>\n</ul>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// list_item_link 的冒泡</span>\n$list_item_link.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  e.<span class=\"hljs-title function_\">preventDefault</span>();\n}, <span class=\"hljs-literal\">false</span>)\n</code></pre>\n<ul>\n<li>一旦 call 了 preventDefault，在之後傳遞下去的事件裡面也會有效果。<br />\n在#list 的捕獲事件裡面就先寫了 e.preventDefault()，這個效果會在之後傳遞的事件裡面一直延續。因此，等之後事件傳遞到#list_item_link 的時候，你會發現點超連結一樣沒反應。</li>\n</ul>\n<pre class=\"hljs\"><code><span class=\"hljs-comment\">// list 的捕獲</span>\n$list.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;list capturing&#x27;</span>, e.<span class=\"hljs-property\">eventPhase</span>);\n  e.<span class=\"hljs-title function_\">preventDefault</span>();\n}, <span class=\"hljs-literal\">true</span>)\n</code></pre>\n<h2 id=\"常見問題\" title=\"常見問題\"><a href=\"#常見問題\">常見問題</a></h2>\n<h3>1. 試說明事件代理 (event delegation) 的概念？</h3>\n<ul>\n<li>listener 是放在父層身上。這樣透過父節點來處理子節點的事件，就叫做事件代理。</li>\n</ul>\n<pre class=\"hljs\"><code><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">html</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">body</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">ul</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;list&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">li</span> <span class=\"hljs-attr\">data-index</span>=<span class=\"hljs-string\">&quot;1&quot;</span>&gt;</span>1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">li</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">li</span> <span class=\"hljs-attr\">data-index</span>=<span class=\"hljs-string\">&quot;2&quot;</span>&gt;</span>2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">li</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">li</span> <span class=\"hljs-attr\">data-index</span>=<span class=\"hljs-string\">&quot;3&quot;</span>&gt;</span>3<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">li</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">ul</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">body</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">html</span>&gt;</span>\n</code></pre>\n<pre class=\"hljs\"><code>li.<span class=\"hljs-property\">dataset</span>.<span class=\"hljs-property\">index</span>\n  <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&#x27;list&#x27;</span>).<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(e.<span class=\"hljs-property\">target</span>.<span class=\"hljs-title function_\">getAttribute</span>(<span class=\"hljs-string\">&#x27;data-index&#x27;</span>));\n})\n\n</code></pre>\n<p><a  href=\"https://hackmd.io/YL7sONOaTeuILTgrJtbblg?view\" target=\"_blank\" rel=\"noreferrer noopener\">Event Object 1</a><br />\n<a  href=\"https://www.notion.so/3-What-is-Event-Object-How-to-Use-it-5083c7e4e9234e8eaf5bc8fc63c603c4\" target=\"_blank\" rel=\"noreferrer noopener\">Event Object 2</a></p>\n<hr />\n<h3>2. 試說明事件處理中 <code>bubble</code>(false) 和 <code>capture</code>(true) 的差別 (事件的傳遞機制)。</h3>\n<p>兩個原則:</p>\n<ol>\n<li>先捕獲，再冒泡</li>\n<li>當事件傳到 target 本身，沒有分捕獲跟冒泡 ( AT_TARGET，沒有捕獲跟冒泡之分，所以執行順序就會根據你 addEventListener 的順序而定 )</li>\n</ol>\n<p>事件觸發總共有三個階段：</p>\n<ol>\n<li>Capture Phase :<br />\n根節點開始往下傳遞到 target，這邊你將節點加上事件，就會處於 Capture Phase。</li>\n<li>Target Phase :<br />\n所點擊的目標，在 target 身上所加的 eventListenr 會是 Target Phase。</li>\n<li>Bubbling Phase :<br />\n最後，事件再往上從子節點（target）一路逆向傳回去根節點，就叫做 Bubbling Phase</li>\n</ol>\n<img src=\"https://i.stack.imgur.com/njYTe.png\">\n<p>而這邊的 e 裡面就蘊含了許多這次事件的相關參數，其中有一個叫做 eventPhase，是一個數字，表示這個事件在哪一個 Phase 觸發</p>\n<pre class=\"hljs\"><code><span class=\"hljs-keyword\">const</span> $list = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&#x27;list&#x27;</span>);\n$list.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(e.<span class=\"hljs-property\">eventPhase</span>);\n})\n</code></pre>\n<blockquote>\n<p>PhaseType<br />\nconst unsigned short CAPTURING_PHASE = 1;<br />\nconst unsigned short AT_TARGET = 2;<br />\nconst unsigned short BUBBLING_PHASE = 3;</p>\n</blockquote>\n<img src=\"https://static.coderbridge.com/img/techbridge/images/huli/event/event_p2.png\">\n<pre class=\"hljs\"><code><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">get</span> = (<span class=\"hljs-params\">id</span>) =&gt; <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(id);\n<span class=\"hljs-keyword\">const</span> $list = <span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&#x27;list&#x27;</span>);\n<span class=\"hljs-keyword\">const</span> $list_item = <span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&#x27;list_item&#x27;</span>);\n<span class=\"hljs-keyword\">const</span> $list_item_link = <span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&#x27;list_item_link&#x27;</span>);\n\n<span class=\"hljs-comment\">// list 的捕獲</span>\n$list.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;list capturing&#x27;</span>, e.<span class=\"hljs-property\">eventPhase</span>);\n}, <span class=\"hljs-literal\">true</span>)\n\n<span class=\"hljs-comment\">// list 的冒泡</span>\n$list.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;list bubbling&#x27;</span>, e.<span class=\"hljs-property\">eventPhase</span>);\n}, <span class=\"hljs-literal\">false</span>)\n\n<span class=\"hljs-comment\">// list_item 的捕獲</span>\n$list_item.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;list_item capturing&#x27;</span>, e.<span class=\"hljs-property\">eventPhase</span>);\n}, <span class=\"hljs-literal\">true</span>)\n\n<span class=\"hljs-comment\">// list_item 的冒泡</span>\n$list_item.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;list_item bubbling&#x27;</span>, e.<span class=\"hljs-property\">eventPhase</span>);\n}, <span class=\"hljs-literal\">false</span>)\n\n<span class=\"hljs-comment\">// list_item_link 的捕獲</span>\n$list_item_link.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;list_item_link capturing&#x27;</span>, e.<span class=\"hljs-property\">eventPhase</span>);\n}, <span class=\"hljs-literal\">true</span>)\n\n<span class=\"hljs-comment\">// list_item_link 的冒泡</span>\n$list_item_link.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">e</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;list_item_link bubbling&#x27;</span>, e.<span class=\"hljs-property\">eventPhase</span>);\n}, <span class=\"hljs-literal\">false</span>)\n\n\n<span class=\"hljs-comment\">//console</span>\nlist capturing\n<span class=\"hljs-number\">1</span>\nlist_item capturing\n<span class=\"hljs-number\">1</span>\nlist_item_link capturing\n<span class=\"hljs-number\">2</span>\nlist_item_link bubbling\n<span class=\"hljs-number\">2</span>\nlist_item bubbling\n<span class=\"hljs-number\">3</span>\nlist bubbling\n<span class=\"hljs-number\">3</span>\n</code></pre>\n<hr />\n<h3>3. 什麼是事件物件 (event object)，你在程式中如何取得與使用？</h3>\n<p>當監聽事件「發生」時，瀏覽器會去執行 Event Handler，並建立 Event Object，其中會包含許多重要的資訊。以點擊事件舉例，可以注意到幾個：</p>\n<ul>\n<li><code>type : click</code>，事件類型。</li>\n<li><code>target : input.btn</code>，被點擊的對象。</li>\n<li><code>bubbles : true</code>，表示這事件是否是在「冒泡」階段觸發。</li>\n<li><code>altKey : false</code>，表示是否有按著 alt 鍵點擊。</li>\n<li><code>pageX / pageY</code> ，表示事件觸發時，滑鼠座標在網頁的相對位置</li>\n<li>…etc\n<blockquote>\n<p>Advantage: 熟知 event object 可以幫助你設計更多元的互動形式，利用「event.key」去判定各種使用者點擊的狀況，進而判斷不同狀況時，該做出何種反應</p>\n</blockquote>\n</li>\n</ul>\n<pre class=\"hljs\"><code><span class=\"hljs-keyword\">const</span> el = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">querySelector</span>(<span class=\"hljs-string\">&#x27;.btn&#x27;</span>)\nel.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&#x27;click&#x27;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">event</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(event)\n})\n</code></pre>\n","toc":{"title":"[Note] Event Handling","subtitles":["常見問題"]},"wordCount":907}